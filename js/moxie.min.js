var MXI_DEBUG=!0;
(function(X,S){var U=function(){var C={};S.apply(C,arguments);return C.moxie};"function"===typeof define&&define.amd?define("moxie",[],U):"object"===typeof module&&module.exports?module.exports=U():X.moxie=U()})(this||window,function(){(function(X,S){function U(n,q){for(var f,g=[],a=0;a<n.length;++a){if(!(f=R[n[a]]))a:{f=X;for(var b=n[a].split(/[.\/]/),d=0;d<b.length;++d){if(!f[b[d]]){f=void 0;break a}f=f[b[d]]}}if(!f)throw"module definition dependecy not found: "+n[a];g.push(f)}q.apply(null,g)}function C(n,
q,f){if("string"!==typeof n)throw"invalid module definition, module id must be defined and be a string";if(q===S)throw"invalid module definition, dependencies must be specified";if(f===S)throw"invalid module definition, definition function must be specified";U(q,function(){R[n]=f.apply(null,arguments)})}var R={};C("moxie/core/utils/Basic",[],function(){function n(b){return void 0===b?"undefined":null===b?"null":b.nodeType?"node":{}.toString.call(b).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function q(){return f(!1,
!1,arguments)}function f(b,d,c){var e=c[0];g(c,function(h,l){0<l&&g(h,function(k,p){var m=-1!==a(n(k),["array","object"]);if(void 0===k||b&&void 0===e[p])return!0;if(m&&d)a:switch(n(k)){case "array":k=Array.prototype.slice.call(k);break a;case "object":k=q({},k)}n(e[p])===n(k)&&m?f(b,d,[e[p],k]):e[p]=k})});return e}function g(b,d){var c;if(b){try{var e=b.length}catch(h){e=void 0}if(void 0===e||"number"!==typeof e)for(c in b){if(b.hasOwnProperty(c)&&!1===d(b[c],c))break}else for(c=0;c<e&&!1!==d(b[c],
c);c++);}}function a(b,d){if(d){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(d,b);for(var c=0,e=d.length;c<e;c++)if(d[c]===b)return c}return-1}return{guid:function(){var b=0;return function(d){var c=(new Date).getTime().toString(32),e;for(e=0;5>e;e++)c+=Math.floor(65535*Math.random()).toString(32);return(d||"o_")+c+(b++).toString(32)}}(),typeOf:n,extend:q,extendIf:function(){return f(!0,!1,arguments)},extendImmutable:function(){return f(!1,!0,arguments)},extendImmutableIf:function(){return f(!0,
!0,arguments)},clone:function(b){switch(n(b)){case "array":return f(!1,!0,[[],b]);case "object":return f(!1,!0,[{},b]);default:return b}},inherit:function(b,d){function c(){this.constructor=b;if(MXI_DEBUG){var h=b.toString().match(/^function\s([^\(\s]+)/);this.ctorName=h?h[1]:!1}}for(var e in d)({}).hasOwnProperty.call(d,e)&&(b[e]=d[e]);c.prototype=d.prototype;b.prototype=new c;b.parent=d.prototype;return b},each:g,isEmptyObj:function(b){var d;if(!b||"object"!==n(b))return!0;for(d in b)return!1;return!0},
inSeries:function(b,d){function c(h){if("function"===n(b[h]))b[h](function(l){++h<e&&!l?c(h):d(l)})}var e=b.length;"function"!==n(d)&&(d=function(){});b&&b.length||d();c(0)},inParallel:function(b,d){var c=0,e=b.length,h=Array(e);g(b,function(l,k){l(function(p){if(p)return d(p);var m=[].slice.call(arguments);m.shift();h[k]=m;c++;c===e&&(h.unshift(null),d.apply(this,h))})})},inArray:a,arrayDiff:function(b,d){var c=[];"array"!==n(b)&&(b=[b]);"array"!==n(d)&&(d=[d]);for(var e in b)-1===a(b[e],d)&&c.push(b[e]);
return c.length?c:!1},arrayIntersect:function(b,d){var c=[];g(b,function(e){-1!==a(e,d)&&c.push(e)});return c.length?c:null},toArray:function(b){var d,c=[];for(d=0;d<b.length;d++)c[d]=b[d];return c},trim:function(b){return b?String.prototype.trim?String.prototype.trim.call(b):b.toString().replace(/^\s*/,"").replace(/\s*$/,""):b},sprintf:function(b){var d=[].slice.call(arguments,1);return b.replace(/%([a-z])/g,function(c,e){c=d.shift();switch(e){case "s":return c+"";case "d":return parseInt(c,10);
case "f":return parseFloat(c);case "c":return"";default:return c}})},parseSizeStr:function(b){if("string"!==typeof b)return b;var d={t:1099511627776,g:1073741824,m:1048576,k:1024};b=/^([0-9\.]+)([tmgk]?)$/.exec(b.toLowerCase().replace(/[^0-9\.tmkg]/g,""));var c=b[2];b=+b[1];d.hasOwnProperty(c)&&(b*=d[c]);return Math.floor(b)},delay:function(b,d){var c=this;setTimeout(function(){b.call(c)},d||1)}}});C("moxie/core/utils/Encode",[],function(){var n=function(f){return unescape(encodeURIComponent(f))},
q=function(f){return decodeURIComponent(escape(f))};return{utf8_encode:n,utf8_decode:q,atob:function(f,g){if("function"===typeof window.atob)return g?q(window.atob(f)):window.atob(f);var a=0,b=0,d=[];if(!f)return f;f+="";do{var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(a++));var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(a++));var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(a++));
var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(a++));var k=c<<18|e<<12|h<<6|l;c=k>>16&255;e=k>>8&255;k&=255;64==h?d[b++]=String.fromCharCode(c):64==l?d[b++]=String.fromCharCode(c,e):d[b++]=String.fromCharCode(c,e,k)}while(a<f.length);f=d.join("");return g?q(f):f},btoa:function(f,g){g&&(f=n(f));if("function"===typeof window.btoa)return window.btoa(f);var a=g=0,b=[];if(!f)return f;do{var d=f.charCodeAt(g++);var c=f.charCodeAt(g++);var e=f.charCodeAt(g++);
var h=d<<16|c<<8|e;d=h>>18&63;c=h>>12&63;e=h>>6&63;h&=63;b[a++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)}while(g<f.length);g=b.join("");f=f.length%3;return(f?g.slice(0,f-3):g)+"===".slice(f||3)}}});C("moxie/core/utils/Env",["moxie/core/utils/Basic"],
function(n){var q=function(b){var d={has:function(m,y){return-1!==y.toLowerCase().indexOf(m.toLowerCase())},lowerize:function(m){return m.toLowerCase()}},c=function(){for(var m,y=0,r,u,v,x,t,w=arguments;y<w.length;y+=2){t=w[y];var z=w[y+1];if("undefined"===typeof m)for(v in m={},z)r=z[v],"object"===typeof r?m[r[0]]=b:m[r]=b;for(r=u=0;r<t.length;r++)if(x=t[r].exec(this.getUA())){for(v=0;v<z.length;v++)t=x[++u],r=z[v],"object"===typeof r&&0<r.length?2==r.length?m[r[0]]="function"==typeof r[1]?r[1].call(this,
t):r[1]:3==r.length?m[r[0]]="function"!==typeof r[1]||r[1].exec&&r[1].test?t?t.replace(r[1],r[2]):b:t?r[1].call(this,t,r[2]):b:4==r.length&&(m[r[0]]=t?r[3].call(this,t.replace(r[1],r[2])):b):m[r]=t?t:b;break}if(x)break}return m},e=function(m,y){for(var r in y)if("object"===typeof y[r]&&0<y[r].length)for(var u=0;u<y[r].length;u++){if(d.has(y[r][u],m))return"?"===r?b:r}else if(d.has(y[r],m))return"?"===r?b:r;return m},h={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],
Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},l=[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],
["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],
"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",e,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412",
"2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,
/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],k=[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv:([\w\.]+).*(gecko)/i],["version","name"]],p=[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],
["name",["version",e,h]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",e,h]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palmos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name",
"Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return function(m){var y=m||(window&&window.navigator&&window.navigator.userAgent?
window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,l)};this.getEngine=function(){return c.apply(this,k)};this.getOS=function(){return c.apply(this,p)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return y};this.setUA=function(r){y=r;return this};this.setUA(y)}}(),f=function(){var b={access_global_ns:function(){return!!window.moxie},define_property:!1,create_canvas:function(){var d=
document.createElement("canvas");d=!(!d.getContext||!d.getContext("2d"));return b.create_canvas=d},return_response_type:function(d){try{if(-1!==n.inArray(d,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;c.open("get","/");if("responseType"in c)return c.responseType=d,c.responseType!==d?!1:!0}}catch(e){}return!1},use_blob_uri:function(){var d=window.URL;b.use_blob_uri=d&&"createObjectURL"in d&&"revokeObjectURL"in d&&("IE"!==a.browser||a.verComp(a.version,"11.0.46",
">="));return b.use_blob_uri},use_data_uri:function(){var d=new Image;d.onload=function(){b.use_data_uri=1===d.width&&1===d.height};setTimeout(function(){d.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==a.browser||9<=a.version)},use_data_uri_of:function(d){return b.use_data_uri&&33E3>d||b.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;
var d=document.createElement("input");d.setAttribute("type","file");return b.use_fileinput=!d.disabled},use_webgl:function(){var d=document.createElement("canvas"),c=null;try{c=d.getContext("webgl")||d.getContext("experimental-webgl")}catch(e){}c||(c=null);d=!!c;return b.use_webgl=d}};return function(d){var c=[].slice.call(arguments);c.shift();return"function"===n.typeOf(b[d])?b[d].apply(this,c):!!b[d]}}(),g=(new q).getResult(),a={can:f,uaParser:q,browser:g.browser.name,version:g.browser.version,
os:g.os.name,osVersion:g.os.version,verComp:function(b,d,c){var e=0,h=0,l=0,k={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1};e=function(m){m=(""+m).replace(/[_\-+]/g,".");m=m.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return m.length?m.split("."):[-8]};var p=function(m){return m?isNaN(m)?k[m]||-7:parseInt(m,10):0};b=e(b);d=e(d);h=Math.max(b.length,d.length);for(e=0;e<h;e++)if(b[e]!=d[e])if(b[e]=p(b[e]),d[e]=p(d[e]),b[e]<d[e]){l=-1;break}else if(b[e]>d[e]){l=1;break}if(!c)return l;
switch(c){case ">":case "gt":return 0<l;case ">=":case "ge":return 0<=l;case "<=":case "le":return 0>=l;case "==":case "=":case "eq":return 0===l;case "<>":case "!=":case "ne":return 0!==l;case "":case "<":case "lt":return 0>l;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};a.OS=a.os;MXI_DEBUG&&(a.debug={runtime:!0,events:!1},a.log=function(){if(window&&window.console&&window.console.log&&
window.console.log.apply)window.console.log.apply(window.console,arguments);else if(document){var b=document.getElementById("moxie-console");b||(b=document.createElement("pre"),b.id="moxie-console",document.body.appendChild(b));var d=arguments[0];if("string"===n.typeOf(d))d=n.sprintf.apply(this,arguments);else if(-1!==n.inArray(n.typeOf(d),["object","array"])){b.appendChild(document.createTextNode(d+"\n"));return}b.appendChild(document.createTextNode(d+"\n"))}});return a});C("moxie/core/Exceptions",
["moxie/core/utils/Basic"],function(n){function q(f,g){for(var a in f)if(f[a]===g)return a;return null}return{RuntimeError:function(){function f(a,b){this.code=a;this.name=q(g,a);this.message=this.name+(b||": RuntimeError "+this.code)}var g={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};n.extend(f,g);f.prototype=Error.prototype;return f}(),OperationNotAllowedException:function(){function f(g){this.code=g;this.name="OperationNotAllowedException"}n.extend(f,{NOT_ALLOWED_ERR:1});f.prototype=
Error.prototype;return f}(),ImageError:function(){function f(a){this.code=a;this.name=q(g,a);this.message=this.name+": ImageError "+this.code}var g={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};n.extend(f,g);f.prototype=Error.prototype;return f}(),FileException:function(){function f(a){this.code=a;this.name=q(g,a);this.message=this.name+": FileException "+this.code}var g={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,
SYNTAX_ERR:8};n.extend(f,g);f.prototype=Error.prototype;return f}(),DOMException:function(){function f(a){this.code=a;this.name=q(g,a);this.message=this.name+": DOMException "+this.code}var g={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,
VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};n.extend(f,g);f.prototype=Error.prototype;return f}(),EventException:function(){function f(g){this.code=g;this.name="EventException"}n.extend(f,{UNSPECIFIED_EVENT_TYPE_ERR:0});f.prototype=Error.prototype;return f}()}});C("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(n){var q=function(f,g){return f.className?
(new RegExp("(^|\\s+)"+g+"(\\s+|$)")).test(f.className):!1};return{get:function(f){return"string"!==typeof f?f:document.getElementById(f)},hasClass:q,addClass:function(f,g){q(f,g)||(f.className=f.className?f.className.replace(/\s+$/,"")+" "+g:g)},removeClass:function(f,g){f.className&&(f.className=f.className.replace(new RegExp("(^|\\s+)"+g+"(\\s+|$)"),function(a,b,d){return" "===b&&" "===d?" ":""}))},getStyle:function(f,g){if(f.currentStyle)return f.currentStyle[g];if(window.getComputedStyle)return window.getComputedStyle(f,
null)[g]},getPos:function(f,g){function a(h){var l=0;var k=0;h&&(k=h.getBoundingClientRect(),h="CSS1Compat"===e.compatMode?e.documentElement:e.body,l=k.left+h.scrollLeft,k=k.top+h.scrollTop);return{x:l,y:k}}var b=0,d=0,c,e=document;g=g||e.body;if(f&&f.getBoundingClientRect&&"IE"===n.browser&&(!e.documentMode||8>e.documentMode))return f=a(f),g=a(g),{x:f.x-g.x,y:f.y-g.y};for(c=f;c&&c!=g&&c.nodeType;)b+=c.offsetLeft||0,d+=c.offsetTop||0,c=c.offsetParent;for(c=f.parentNode;c&&c!=g&&c.nodeType;)b-=c.scrollLeft||
0,d-=c.scrollTop||0,c=c.parentNode;return{x:b,y:d}},getSize:function(f){return{w:f.offsetWidth||f.clientWidth,h:f.offsetHeight||f.clientHeight}}}});C("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(n,q,f){function g(){this.uid=f.guid()}var a={};f.extend(g.prototype,{init:function(){this.uid||(this.uid=f.guid("uid_"))},addEventListener:function(b,d,c,e){var h=this;this.hasOwnProperty("uid")||(this.uid=f.guid("uid_"));b=f.trim(b);if(/\s/.test(b))f.each(b.split(/\s+/),
function(k){h.addEventListener(k,d,c,e)});else{b=b.toLowerCase();c=parseInt(c,10)||0;var l=a[this.uid]&&a[this.uid][b]||[];l.push({fn:d,priority:c,scope:e||this});a[this.uid]||(a[this.uid]={});a[this.uid][b]=l}},hasEventListener:function(b){b?(b=b.toLowerCase(),b=a[this.uid]&&a[this.uid][b]):b=a[this.uid];return b?b:!1},removeEventListener:function(b,d){var c=this,e,h;b=b.toLowerCase();if(/\s/.test(b))f.each(b.split(/\s+/),function(l){c.removeEventListener(l,d)});else if(e=a[this.uid]&&a[this.uid][b]){if(d)for(h=
e.length-1;0<=h;h--){if(e[h].fn===d){e.splice(h,1);break}}else e=[];e.length||(delete a[this.uid][b],f.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var d,c={},e=!0;if("string"!==f.typeOf(b)){var h=b;if("string"===f.typeOf(h.type))b=h.type,void 0!==h.total&&void 0!==h.loaded&&(c.total=h.total,c.loaded=h.loaded),c.async=h.async||!1;else throw new q.EventException(q.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
}-1!==b.indexOf("::")?function(p){d=p[0];b=p[1]}(b.split("::")):d=this.uid;b=b.toLowerCase();if(h=a[d]&&a[d][b]){h.sort(function(p,m){return m.priority-p.priority});var l=[].slice.call(arguments);l.shift();c.type=b;l.unshift(c);MXI_DEBUG&&n.debug.events&&n.log("%cEvent '%s' fired on %s","color: #999;",c.type,(this.ctorName?this.ctorName+"::":"")+d);var k=[];f.each(h,function(p){l[0].target=p.scope;c.async?k.push(function(m){setTimeout(function(){m(!1===p.fn.apply(p.scope,l))},1)}):k.push(function(m){m(!1===
p.fn.apply(p.scope,l))})});k.length&&f.inSeries(k,function(p){e=!p})}return e},bindOnce:function(b,d,c,e){var h=this;h.bind.call(this,b,function k(){h.unbind(b,k);return d.apply(this,arguments)},c,e)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(b){var d=
this;this.bind(b.join(" "),function(c){var e="on"+c.type.toLowerCase();"function"===f.typeOf(this[e])&&this[e].apply(this,arguments)});f.each(b,function(c){c="on"+c.toLowerCase(c);"undefined"===f.typeOf(d[c])&&(d[c]=null)})}});g.instance=new g;return g});C("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(n,q,f,g){function a(c,e,h,l,k){var p=this,m=q.guid(e+"_");k=k||"browser";c=c||{};d[m]=this;h=q.extend({access_binary:!1,
access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},h);c.preferred_caps&&(k=a.getMode(l,c.preferred_caps,k));MXI_DEBUG&&
n.debug.runtime&&n.log("\tdefault mode: %s",k);var y=function(){var r={};return{exec:function(u,v,x,t){if(y[v]&&(r[u]||(r[u]={context:this,instance:new y[v]}),r[u].instance[x]))return r[u].instance[x].apply(this,t)},removeInstance:function(u){delete r[u]},removeAllInstances:function(){var u=this;q.each(r,function(v,x){"function"===q.typeOf(v.instance.destroy)&&v.instance.destroy.call(v.context);u.removeInstance(x)})}}}();q.extend(this,{initialized:!1,uid:m,type:e,mode:a.getMode(l,c.required_caps,
k),shimid:m+"_container",clients:0,options:c,can:function(r,u,v){v=v||h;"string"===q.typeOf(r)&&"undefined"===q.typeOf(u)&&(r=a.parseCaps(r));if("object"===q.typeOf(r)){for(var x in r)if(!this.can(x,r[x],v))return!1;return!0}return"function"===q.typeOf(v[r])?v[r].call(this,u):u===v[r]},getShimContainer:function(){var r=f.get(this.shimid);if(!r){var u=f.get(this.options.container)||document.body;r=document.createElement("div");r.id=this.shimid;r.className="moxie-shim moxie-shim-"+this.type;q.extend(r.style,
{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});u.appendChild(r)}return r},getShim:function(){return y},shimExec:function(r,u){var v=[].slice.call(arguments,2);return p.getShim().exec.call(this,this.uid,r,u,v)},exec:function(r,u){var v=[].slice.call(arguments,2);return p[r]&&p[r][u]?p[r][u].apply(this,v):p.shimExec.apply(this,arguments)},destroy:function(){if(p){var r=f.get(this.shimid);r&&r.parentNode.removeChild(r);y&&y.removeAllInstances();this.unbindAll();
delete d[this.uid];m=p=y=this.uid=null}}});this.mode&&c.required_caps&&!this.can(c.required_caps)&&(this.mode=!1)}var b={},d={};a.order="html5,flash,silverlight,html4";a.getRuntime=function(c){return d[c]?d[c]:!1};a.addConstructor=function(c,e){e.prototype=g.instance;b[c]=e};a.getConstructor=function(c){return b[c]||null};a.getInfo=function(c){var e=a.getRuntime(c);return e?{uid:e.uid,type:e.type,mode:e.mode,can:function(){return e.can.apply(e,arguments)}}:null};a.parseCaps=function(c){var e={};if("string"!==
q.typeOf(c))return c||{};q.each(c.split(","),function(h){e[h]=!0});return e};a.can=function(c,e){return(c=a.getConstructor(c))?(e=new c({required_caps:e}),c=e.mode,e.destroy(),!!c):!1};a.thatCan=function(c,e){e=(e||a.order).split(/\s*,\s*/);for(var h in e)if(a.can(e[h],c))return e[h];return null};a.getMode=function(c,e,h){var l=null;"undefined"===q.typeOf(h)&&(h="browser");if(e&&!q.isEmptyObj(c)){q.each(e,function(k,p){if(c.hasOwnProperty(p)){var m=c[p](k);"string"===typeof m&&(m=[m]);if(!l)l=m;else if(!(l=
q.arrayIntersect(l,m)))return MXI_DEBUG&&n.debug.runtime&&n.log("\t\t%s: %s (conflicting mode requested: %s)",p,k,m),l=!1}MXI_DEBUG&&n.debug.runtime&&n.log("\t\t%s: %s (compatible modes: %s)",p,k,l)});if(l)return-1!==q.inArray(h,l)?h:l[0];if(!1===l)return!1}return h};a.getGlobalEventTarget=function(){if(/^moxie\./.test(n.global_event_dispatcher)&&!n.can("access_global_ns")){var c=q.guid("moxie_event_target_");window[c]=function(e,h){g.instance.dispatchEvent(e,h)};n.global_event_dispatcher=c}return n.global_event_dispatcher};
a.capTrue=function(){return!0};a.capFalse=function(){return!1};a.capTest=function(c){return function(){return!!c}};return a});C("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(n,q,f,g){return function(){var a;f.extend(this,{connectRuntime:function(b){function d(h){var l;if(h.length){var k=h.shift().toLowerCase();(l=g.getConstructor(k))?(MXI_DEBUG&&n.debug.runtime&&(n.log("Trying runtime: %s",k),n.log(b)),a=new l(b),
a.bind("Init",function(){a.initialized=!0;MXI_DEBUG&&n.debug.runtime&&n.log("Runtime '%s' initialized",a.type);setTimeout(function(){a.clients++;c.ruid=a.uid;c.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){MXI_DEBUG&&n.debug.runtime&&n.log("Runtime '%s' failed to initialize",a.type);a.destroy();d(h)}),a.bind("Exception",function(p,m){p=m.name+"(#"+m.code+")"+(m.message?", from: "+m.message:"");MXI_DEBUG&&n.debug.runtime&&n.log("Runtime '%s' has thrown an exception: %s",this.type,p);c.trigger("RuntimeError",
new q.RuntimeError(q.RuntimeError.EXCEPTION_ERR,p))}),MXI_DEBUG&&n.debug.runtime&&n.log("\tselected mode: %s",a.mode),a.mode?a.init():a.trigger("Error")):(MXI_DEBUG&&n.debug.runtime&&n.log("Constructor for '%s' runtime is not available.",k),d(h))}else c.trigger("RuntimeError",new q.RuntimeError(q.RuntimeError.NOT_INIT_ERR)),a=null}var c=this;if("string"===f.typeOf(b))var e=b;else"string"===f.typeOf(b.ruid)&&(e=b.ruid);if(e){if(a=g.getRuntime(e))return c.ruid=e,a.clients++,a;throw new q.RuntimeError(q.RuntimeError.NOT_INIT_ERR);
}d((b.runtime_order||g.order).split(/\s*,\s*/))},disconnectRuntime:function(){a&&0>=--a.clients&&a.destroy();a=null},getRuntime:function(){return a&&a.uid?a:a=null},exec:function(){return a?a.exec.apply(this,arguments):null},can:function(b){return a?a.can(b):!1}})}});C("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(n,q,f){function g(b,d){function c(e,h,l){var k=a[this.uid];if("string"!==n.typeOf(k)||!k.length)return null;h=new g(null,
{type:l,size:h-e});h.detach(k.substr(e,h.size));return h}f.call(this);b&&this.connectRuntime(b);d?"string"===n.typeOf(d)&&(d={data:d}):d={};n.extend(this,{uid:d.uid||n.guid("uid_"),ruid:b,size:d.size||0,type:d.type||"",slice:function(e,h,l){return this.isDetached()?c.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,h,l)},getSource:function(){return a[this.uid]?a[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),
this.disconnectRuntime(),this.ruid=null);e=e||"";if("data:"==e.substr(0,5)){var h=e.indexOf(";base64,");this.type=e.substring(5,h);e=q.atob(e.substring(h+8))}this.size=e.length;a[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===n.typeOf(a[this.uid])},destroy:function(){this.detach();delete a[this.uid]}});d.data?this.detach(d.data):a[this.uid]=d}var a={};return g});C("moxie/core/I18n",["moxie/core/utils/Basic"],function(n){var q={};return{addI18n:function(f){return n.extend(q,f)},translate:function(f){return q[f]||
f},_:function(f){return this.translate(f)},sprintf:function(f){var g=[].slice.call(arguments,1);return f.replace(/%[a-z]/g,function(){var a=g.shift();return"undefined"!==n.typeOf(a)?a:""})}}});C("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(n,q){var f={},g={},a=function(c){c=c.split(/,/);var e,h;for(e=0;e<c.length;e+=2){var l=c[e+1].split(/ /);for(h=0;h<l.length;h++)f[l[h]]=c[e];g[c[e]]=l}},b=function(c){var e=[];n.each(c,function(h){h=h.toLowerCase();if("*"===h)return e=
[],!1;var l=h.match(/^(\w+)\/(\*|\w+)$/);l&&("*"===l[2]?n.each(g,function(k,p){(new RegExp("^"+l[1]+"/")).test(p)&&[].push.apply(e,g[p])}):g[h]&&[].push.apply(e,g[h]))});return e},d=function(c){return(c=c&&c.match(/\.([^.]+)$/))?c[1].toLowerCase():""};a("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
return{mimes:f,extensions:g,addMimeType:a,extList2mimes:function(c,e){var h,l,k=[];for(h=0;h<c.length;h++){var p=c[h].extensions.toLowerCase().split(/\s*,\s*/);for(l=0;l<p.length;l++){if("*"===p[l])return[];var m=k[p[l]];if(e&&/^\w+$/.test(p[l]))k.push("."+p[l]);else if(m&&-1===n.inArray(m,k))k.push(m);else if(!m)return[]}}return k},mimes2exts:b,mimes2extList:function(c){var e=[];"string"===n.typeOf(c)&&(c=n.trim(c).split(/\s*,\s*/));c=b(c);e.push({title:q.translate("Files"),extensions:c.length?c.join(","):
"*"});return e},getFileExtension:d,getFileMime:function(c){return f[d(c)]||""}}});C("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Env moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(n,q,f,g,a,b,d,c,e){function h(k){MXI_DEBUG&&q.log("Instantiating FileInput...");-1!==n.inArray(n.typeOf(k),["string","node"])&&(k={browse_button:k});var p=g.get(k.browse_button);
if(!p)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);p={accept:[{title:d.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:p.parentNode||document.body};k=n.extend({},p,k);"string"===typeof k.required_caps&&(k.required_caps=c.parseCaps(k.required_caps));"string"===typeof k.accept&&(k.accept=f.mimes2extList(k.accept));p=g.get(k.container);p||(p=document.body);"static"===g.getStyle(p,"position")&&(p.style.position="relative");p=p=null;e.call(this);n.extend(this,{uid:n.guid("uid_"),
ruid:null,shimid:null,files:null,init:function(){var m=this;m.bind("RuntimeInit",function(y,r){m.ruid=r.uid;m.shimid=r.shimid;m.bind("Ready",function(){m.trigger("Refresh")},999);m.bind("Refresh",function(){var u=g.get(k.browse_button);var v=g.get(r.shimid);if(u){var x=g.getPos(u,g.get(k.container));var t=g.getSize(u);u=parseInt(g.getStyle(u,"z-index"),10)||0;v&&n.extend(v.style,{top:x.y+"px",left:x.x+"px",width:t.w+"px",height:t.h+"px",zIndex:u+1})}});r.exec.call(m,"FileInput","init",k)});m.connectRuntime(n.extend({},
k,{required_caps:{select_file:!0}}))},getOption:function(m){return k[m]},setOption:function(m,y){if(k.hasOwnProperty(m)){var r=k[m];switch(m){case "accept":"string"===typeof y&&(y=f.mimes2extList(y));break;case "container":case "required_caps":throw new a.FileException(a.FileException.NO_MODIFICATION_ALLOWED_ERR);}k[m]=y;this.exec("FileInput","setOption",m,y);this.trigger("OptionChanged",m,y,r)}},disable:function(m){this.getRuntime()&&this.exec("FileInput","disable","undefined"===n.typeOf(m)?!0:m)},
refresh:function(){this.trigger("Refresh")},destroy:function(){var m=this.getRuntime();m&&(m.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===n.typeOf(this.files)&&n.each(this.files,function(y){y.destroy()});this.files=null;this.unbindAll()}});this.handleEventProps(l)}var l="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");h.prototype=b.instance;return h});C("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(n,
q,f){function g(a,b){b||(b={});f.apply(this,arguments);this.type||(this.type=q.getFileMime(b.name));if(b.name){var d=b.name.replace(/\\/g,"/");d=d.substr(d.lastIndexOf("/")+1)}else this.type&&(d=this.type.split("/")[0],d=n.guid((""!==d?d:"file")+"_"),q.extensions[this.type]&&(d+="."+q.extensions[this.type][0]));n.extend(this,{name:d||n.guid("file_"),relativePath:"",lastModifiedDate:b.lastModifiedDate||(new Date).toLocaleString()})}g.prototype=f.prototype;return g});C("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/core/utils/Env moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
function(n,q,f,g,a,b,d,c,e){function h(k){MXI_DEBUG&&a.log("Instantiating FileDrop...");var p=this;"string"===typeof k&&(k={drop_zone:k});var m={accept:[{title:n.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};k="object"===typeof k?g.extend({},m,k):m;k.container=q.get(k.drop_zone)||document.body;"static"===q.getStyle(k.container,"position")&&(k.container.style.position="relative");"string"===typeof k.accept&&(k.accept=e.mimes2extList(k.accept));d.call(p);g.extend(p,{uid:g.guid("uid_"),
ruid:null,files:null,init:function(){p.bind("RuntimeInit",function(y,r){p.ruid=r.uid;r.exec.call(p,"FileDrop","init",k);p.dispatchEvent("ready")});p.connectRuntime(k)},destroy:function(){var y=this.getRuntime();y&&(y.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null;this.unbindAll()}});this.handleEventProps(l)}var l=["ready","dragenter","dragleave","drop","error"];h.prototype=c.instance;return h});C("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/runtime/RuntimeClient".split(" "),
function(n,q,f,g,a,b){function d(){function e(h,l){this.trigger("loadstart");if(this.readyState===d.LOADING)this.trigger("error",new f.DOMException(f.DOMException.INVALID_STATE_ERR)),this.trigger("loadend");else if(l instanceof a)if(this.result=null,this.readyState=d.LOADING,l.isDetached()){var k=l.getSource();switch(h){case "readAsText":case "readAsBinaryString":this.result=k;break;case "readAsDataURL":this.result="data:"+l.type+";base64,"+q.btoa(k)}this.readyState=d.DONE;this.trigger("load");this.trigger("loadend")}else this.connectRuntime(l.ruid),
this.exec("FileReader","read",h,l);else this.trigger("error",new f.DOMException(f.DOMException.NOT_FOUND_ERR)),this.trigger("loadend")}b.call(this);n.extend(this,{uid:n.guid("uid_"),readyState:d.EMPTY,result:null,error:null,readAsBinaryString:function(h){e.call(this,"readAsBinaryString",h)},readAsDataURL:function(h){e.call(this,"readAsDataURL",h)},readAsText:function(h){e.call(this,"readAsText",h)},abort:function(){this.result=null;-1===n.inArray(this.readyState,[d.EMPTY,d.DONE])&&(this.readyState===
d.LOADING&&(this.readyState=d.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(c);this.bind("Error",function(h,l){this.readyState=d.DONE;this.error=l},999);this.bind("Load",function(h){this.readyState=d.DONE},999)}var c="loadstart progress load abort error loadend".split(" ");d.EMPTY=0;d.LOADING=1;d.DONE=2;d.prototype=g.instance;
return d});C("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(n){var q=function(f,g){var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),b=a.length,d={http:80,https:443},c={},e=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(f||"");f=/^\/\/\w/.test(f);switch(n.typeOf(g)){case "undefined":g=q(document.location.href,
!1);break;case "string":g=q(g,!1)}for(;b--;)e[b]&&(c[a[b]]=e[b]);a=!f&&!c.scheme;if(f||a)c.scheme=g.scheme;a&&(c.host=g.host,c.port=g.port,a="",/^[^\/]/.test(c.path)&&(a=g.path,a=/\/[^\/]*\.[^\/]*$/.test(a)?a.replace(/\/[^\/]+$/,"/"):a.replace(/\/?$/,"/")),c.path=a+(c.path||""));c.port||(c.port=d[c.scheme]||80);c.port=parseInt(c.port,10);c.path||(c.path="/");delete c.source;return c};return{parseUrl:q,resolveUrl:function(f){f="object"===typeof f?f:q(f);return f.scheme+"://"+f.host+(f.port!=={http:80,
https:443}[f.scheme]?":"+f.port:"")+f.path+(f.query?f.query:"")},hasSameOrigin:function(f){function g(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof f&&(f=q(f));return g(q())===g(f)}}});C("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(n,q,f){function g(){this.uid=n.guid("uid_");q.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}g.prototype=f.instance;return g});C("moxie/file/FileReaderSync",
["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(n,q,f){return function(){function g(a,b){if(b.isDetached()){var d=b.getSource();switch(a){case "readAsBinaryString":return d;case "readAsDataURL":return"data:"+b.type+";base64,"+f.btoa(d);case "readAsText":a="";b=0;for(var c=d.length;b<c;b++)a+=String.fromCharCode(d[b]);return a}}else return d=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b),this.disconnectRuntime(),d}q.call(this);n.extend(this,
{uid:n.guid("uid_"),readAsBinaryString:function(a){return g.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return g.call(this,"readAsDataURL",a)},readAsText:function(a){return g.call(this,"readAsText",a)}})}});C("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(n,q,f){return function(){var g,a=[];q.extend(this,{append:function(b,d){var c=this,e=q.typeOf(d);d instanceof f?g={name:b,value:d}:"array"===e?(b+="[]",q.each(d,function(h){c.append(b,
h)})):"object"===e?q.each(d,function(h,l){c.append(b+"["+l+"]",h)}):"null"===e||"undefined"===e||"number"===e&&isNaN(d)?c.append(b,"false"):a.push({name:b,value:d.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return g&&g.value||null},getBlobName:function(){return g&&g.name||null},each:function(b){q.each(a,function(d){b(d.value,d.name)});g&&b(g.value,g.name)},destroy:function(){g=null;a=[]}})}});C("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
function(n,q,f,g,a,b,d,c,e,h,l,k){function p(){this.uid=n.guid("uid_")}function m(){function u(D,G){if(t.hasOwnProperty(D)){if(1===arguments.length)return l.can("define_property")?t[D]:x[D];l.can("define_property")?t[D]=G:x[D]=G}}function v(D){function G(){J&&(J.destroy(),J=null);L.dispatchEvent("loadend");L=null}function Y(Q){J.bind("LoadStart",function(N){u("readyState",m.LOADING);L.dispatchEvent("readystatechange");L.dispatchEvent(N);P&&L.upload.dispatchEvent(N)});J.bind("Progress",function(N){u("readyState")!==
m.LOADING&&(u("readyState",m.LOADING),L.dispatchEvent("readystatechange"));L.dispatchEvent(N)});J.bind("UploadProgress",function(N){P&&L.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:N.total,loaded:N.loaded})});J.bind("Load",function(N){u("readyState",m.DONE);u("status",Number(Q.exec.call(J,"XMLHttpRequest","getStatus")||0));u("statusText",y[u("status")]||"");u("response",Q.exec.call(J,"XMLHttpRequest","getResponse",u("responseType")));~n.inArray(u("responseType"),["text",""])?u("responseText",
u("response")):"document"===u("responseType")&&u("responseXML",u("response"));V=Q.exec.call(J,"XMLHttpRequest","getAllResponseHeaders");L.dispatchEvent("readystatechange");0<u("status")?(P&&L.upload.dispatchEvent(N),L.dispatchEvent(N)):(W=!0,L.dispatchEvent("error"));G()});J.bind("Abort",function(N){L.dispatchEvent(N);G()});J.bind("Error",function(N){W=!0;u("readyState",m.DONE);L.dispatchEvent("readystatechange");Z=!0;L.dispatchEvent(N);G()});Q.exec.call(J,"XMLHttpRequest","send",{url:z,method:B,
async:w,user:A,password:F,headers:E,mimeType:H,encoding:K,responseType:L.responseType,withCredentials:L.withCredentials,options:O},D)}var L=this;(new Date).getTime();J=new d;"string"===typeof O.required_caps&&(O.required_caps=b.parseCaps(O.required_caps));O.required_caps=n.extend({},O.required_caps,{return_response_type:L.responseType});D instanceof h&&(O.required_caps.send_multipart=!0);n.isEmptyObj(E)||(O.required_caps.send_custom_headers=!0);aa||(O.required_caps.do_cors=!0);O.ruid?Y(J.connectRuntime(O)):
(J.bind("RuntimeInit",function(Q,N){Y(N)}),J.bind("RuntimeError",function(Q,N){L.dispatchEvent("RuntimeError",N)}),J.connectRuntime(O))}var x=this,t={timeout:0,readyState:m.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},w=!0,z,B,E={},A,F,K=null,H=null,I=!1,M=!1,P=!1,Z=!1,W=!1,aa=!1,O={},J,V="",T;n.extend(this,t,{uid:n.guid("uid_"),upload:new p,open:function(D,G,Y,L,Q){if(!D||!G)throw new q.DOMException(q.DOMException.SYNTAX_ERR);
if(/[\u0100-\uffff]/.test(D)||g.utf8_encode(D)!==D)throw new q.DOMException(q.DOMException.SYNTAX_ERR);~n.inArray(D.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(B=D.toUpperCase());if(~n.inArray(B,["CONNECT","TRACE","TRACK"]))throw new q.DOMException(q.DOMException.SECURITY_ERR);G=g.utf8_encode(G);D=a.parseUrl(G);aa=a.hasSameOrigin(D);z=a.resolveUrl(G);if((L||Q)&&!aa)throw new q.DOMException(q.DOMException.INVALID_ACCESS_ERR);A=L||D.user;F=Q||D.pass;w=Y||!0;if(!1===
w&&(u("timeout")||u("withCredentials")||""!==u("responseType")))throw new q.DOMException(q.DOMException.INVALID_ACCESS_ERR);I=!w;M=!1;E={};u("responseText","");u("responseXML",null);u("response",null);u("status",0);u("statusText","");u("readyState",m.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(D,G){if(u("readyState")!==m.OPENED||M)throw new q.DOMException(q.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(D)||g.utf8_encode(D)!==D)throw new q.DOMException(q.DOMException.SYNTAX_ERR);
D=n.trim(D).toLowerCase();if(~n.inArray(D,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(D))return!1;E[D]=E[D]?E[D]+(", "+G):G;return!0},hasRequestHeader:function(D){return D&&E[D.toLowerCase()]||!1},getAllResponseHeaders:function(){return V||""},getResponseHeader:function(D){D=
D.toLowerCase();return W||~n.inArray(D,["set-cookie","set-cookie2"])?null:V&&""!==V&&(T||(T={},n.each(V.split(/\r\n/),function(G){G=G.split(/:\s+/);2===G.length&&(G[0]=n.trim(G[0]),T[G[0].toLowerCase()]={header:G[0],value:n.trim(G[1])})})),T.hasOwnProperty(D))?T[D].header+": "+T[D].value:null},overrideMimeType:function(D){var G;if(~n.inArray(u("readyState"),[m.LOADING,m.DONE]))throw new q.DOMException(q.DOMException.INVALID_STATE_ERR);D=n.trim(D.toLowerCase());/;/.test(D)&&(G=D.match(/^([^;]+)(?:;\scharset=)?(.*)$/))&&
(D=G[1]);if(!k.mimes[D])throw new q.DOMException(q.DOMException.SYNTAX_ERR);},send:function(D,G){O="string"===n.typeOf(G)?{ruid:G}:G?G:{};if(this.readyState!==m.OPENED||M)throw new q.DOMException(q.DOMException.INVALID_STATE_ERR);D instanceof c?(O.ruid=D.ruid,H=D.type||"application/octet-stream"):D instanceof h?D.hasBlob()&&(G=D.getBlob(),O.ruid=G.ruid,H=G.type||"application/octet-stream"):"string"===typeof D&&(K="UTF-8",H="text/plain;charset=UTF-8",D=g.utf8_encode(D));this.withCredentials||(this.withCredentials=
O.required_caps&&O.required_caps.send_browser_cookies&&!aa);P=!I&&this.upload.hasEventListener();W=!1;Z=!D;I||(M=!0);v.call(this,D)},abort:function(){W=!0;I=!1;if(~n.inArray(u("readyState"),[m.UNSENT,m.OPENED,m.DONE]))u("readyState",m.UNSENT);else{u("readyState",m.DONE);M=!1;if(J)J.getRuntime().exec.call(J,"XMLHttpRequest","abort",Z);else throw new q.DOMException(q.DOMException.INVALID_STATE_ERR);Z=!0}},destroy:function(){J&&("function"===n.typeOf(J.destroy)&&J.destroy(),J=null);this.unbindAll();
this.upload&&(this.upload.unbindAll(),this.upload=null)}});this.handleEventProps(r.concat(["readystatechange"]));this.upload.handleEventProps(r)}var y={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",
307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",
426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=f.instance;var r="loadstart progress abort error load timeout loadend".split(" ");m.UNSENT=0;m.OPENED=1;m.HEADERS_RECEIVED=2;m.LOADING=3;m.DONE=4;m.prototype=f.instance;return m});C("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode",
"moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(n,q,f,g){function a(){function b(m,y){var r=this;e=y;r.bind("TransportingProgress",function(u){k=u.loaded;k<l&&-1===n.inArray(r.state,[a.IDLE,a.DONE])&&d.call(r)},999);r.bind("TransportingComplete",function(){k=l;r.state=a.DONE;h=null;r.result=e.exec.call(r,"Transporter","getAsBlob",m||"")},999);r.state=a.BUSY;r.trigger("TransportingStarted");d.call(r)}function d(){var m=l-k;p>m&&(p=m);m=q.btoa(h.substr(k,p));e.exec.call(this,"Transporter",
"receive",m,l)}var c,e,h,l,k,p;f.call(this);n.extend(this,{uid:n.guid("uid_"),state:a.IDLE,result:null,transport:function(m,y,r){var u=this;r=n.extend({chunk_size:204798},r);if(c=r.chunk_size%3)r.chunk_size+=3-c;p=r.chunk_size;l=k=0;h=this.result=null;h=m;l=m.length;if("string"===n.typeOf(r)||r.ruid)b.call(u,y,this.connectRuntime(r));else{var v=function(x,t){u.unbind("RuntimeInit",v);b.call(u,y,t)};this.bind("RuntimeInit",v);this.connectRuntime(r)}},abort:function(){this.state=a.IDLE;e&&(e.exec.call(this,
"Transporter","clear"),this.trigger("TransportingAborted"));l=k=0;h=this.result=null},destroy:function(){this.unbindAll();e=null;this.disconnectRuntime();l=k=0;h=this.result=null}})}a.IDLE=0;a.BUSY=1;a.DONE=2;a.prototype=g.instance;return a});C("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(n,q,f,g,a,b,d,c,e,h,l,k,p){function m(){function r(t){var w=n.typeOf(t);try{if(t instanceof m){if(!t.size)throw new f.DOMException(f.DOMException.INVALID_STATE_ERR);u.apply(this,arguments)}else if(t instanceof l){if(!~n.inArray(t.type,["image/jpeg","image/png"]))throw new f.ImageError(f.ImageError.WRONG_FORMAT);v.apply(this,arguments)}else if(-1!==n.inArray(w,["blob","file"]))r.call(this,new k(null,t),arguments[1]);else if("string"===w)"data:"===t.substr(0,5)?r.call(this,new l(null,{data:t}),
arguments[1]):x.apply(this,arguments);else if("node"===w&&"img"===t.nodeName.toLowerCase())r.call(this,t.src,arguments[1]);else throw new f.DOMException(f.DOMException.TYPE_MISMATCH_ERR);}catch(z){this.trigger("error",z.code)}}function u(t,w){var z=this.connectRuntime(t.ruid);this.ruid=z.uid;z.exec.call(this,"Image","loadFromImage",t,"undefined"===n.typeOf(w)?!0:w)}function v(t,w){function z(E){B.ruid=E.uid;E.exec.call(B,"Image","loadFromBlob",t)}var B=this;B.name=t.name||"";t.isDetached()?(this.bind("RuntimeInit",
function(E,A){z(A)}),w&&"string"===typeof w.required_caps&&(w.required_caps=b.parseCaps(w.required_caps)),this.connectRuntime(n.extend({required_caps:{access_image_binary:!0,resize_image:!0}},w))):z(this.connectRuntime(t.ruid))}function x(t,w){var z=this;var B=new a;B.open("get",t);B.responseType="blob";B.onprogress=function(E){z.trigger(E)};B.onload=function(){v.call(z,B.response,!0)};B.onerror=function(E){z.trigger(E)};B.onloadend=function(){B.destroy()};B.bind("RuntimeError",function(E,A){z.trigger("RuntimeError",
A)});B.send(null,w)}d.call(this);n.extend(this,{uid:n.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){r.apply(this,arguments)},resize:function(t){var w={x:0,y:0,width:this.width,height:this.height},z=n.extendIf({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},t);try{if(!this.size)throw new f.DOMException(f.DOMException.INVALID_STATE_ERR);
if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new f.ImageError(f.ImageError.MAX_RESOLUTION_ERR);var B=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;if(-1!==n.inArray(B,[5,6,7,8])){var E=z.width;z.width=z.height;z.height=E}if(z.crop){var A=Math.max(z.width/this.width,z.height/this.height);t.fit?(w.width=Math.min(Math.ceil(z.width/A),this.width),w.height=Math.min(Math.ceil(z.height/A),this.height),A=z.width/w.width):(w.width=Math.min(z.width,this.width),w.height=
Math.min(z.height,this.height),A=1);"boolean"===typeof z.crop&&(z.crop="cc");switch(z.crop.toLowerCase().replace(/_/,"-")){case "rb":case "right-bottom":w.x=this.width-w.width;w.y=this.height-w.height;break;case "cb":case "center-bottom":w.x=Math.floor((this.width-w.width)/2);w.y=this.height-w.height;break;case "lb":case "left-bottom":w.x=0;w.y=this.height-w.height;break;case "lt":case "left-top":w.x=0;w.y=0;break;case "ct":case "center-top":w.x=Math.floor((this.width-w.width)/2);w.y=0;break;case "rt":case "right-top":w.x=
this.width-w.width;w.y=0;break;case "rc":case "right-center":case "right-middle":w.x=this.width-w.width;w.y=Math.floor((this.height-w.height)/2);break;case "lc":case "left-center":case "left-middle":w.x=0;w.y=Math.floor((this.height-w.height)/2);break;default:w.x=Math.floor((this.width-w.width)/2),w.y=Math.floor((this.height-w.height)/2)}w.x=Math.max(w.x,0);w.y=Math.max(w.y,0)}else A=Math.min(z.width/this.width,z.height/this.height),1<A&&!z.fit&&(A=1);this.exec("Image","resize",w,A,z)}catch(F){this.trigger("error",
F.code)}},downsize:function(t,w,z,B){var E={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"};t="object"===typeof t?n.extend(E,t):n.extend(E,{width:t,height:w,crop:z,preserveHeaders:B});this.resize(t)},crop:function(t,w,z){this.downsize(t,w,!0,z)},getAsCanvas:function(){if(!e.can("create_canvas"))throw new f.RuntimeError(f.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function(t,w){if(!this.size)throw new f.DOMException(f.DOMException.INVALID_STATE_ERR);
return this.exec("Image","getAsBlob",t||"image/jpeg",w||90)},getAsDataURL:function(t,w){if(!this.size)throw new f.DOMException(f.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",t||"image/jpeg",w||90)},getAsBinaryString:function(t,w){t=this.getAsDataURL(t,w);return p.atob(t.substring(t.indexOf("base64,")+7))},embed:function(t,w){function z(K,H){var I=this;if(e.can("create_canvas")){var M=I.getAsCanvas();if(M){t.appendChild(M);M=null;I.destroy();B.trigger("embedded");return}}H=
I.getAsDataURL(K,H);if(!H)throw new f.ImageError(f.ImageError.WRONG_FORMAT);e.can("use_data_uri_of",H.length)?(t.innerHTML='<img src="'+H+'" width="'+I.width+'" height="'+I.height+'" alt="" />',I.destroy(),B.trigger("embedded")):(M=new c,M.bind("TransportingComplete",function(){E=B.connectRuntime(this.result.ruid);B.bind("Embedded",function(){n.extend(E.getShimContainer().style,{top:"0px",left:"0px",width:I.width+"px",height:I.height+"px"});E=null},999);E.exec.call(B,"ImageView","display",this.result.uid,
width,height);I.destroy()}),M.transport(p.atob(H.substring(H.indexOf("base64,")+7)),K,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:t}))}var B=this,E,A=n.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},w);try{if(!(t=q.get(t)))throw new f.DOMException(f.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new f.DOMException(f.DOMException.INVALID_STATE_ERR);var F=new m;F.bind("Resize",function(){z.call(this,
A.type,A.quality)});F.bind("Load",function(){this.downsize(A)});this.meta.thumb&&this.meta.thumb.width>=A.width&&this.meta.thumb.height>=A.height?F.load(this.meta.thumb.data):F.clone(this,!1);return F}catch(K){this.trigger("error",K.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy();this.unbindAll()}});this.handleEventProps(y);this.bind("Load Resize",function(){var t=void 0;
try{t||(t=this.exec("Image","getInfo"));this.size=t.size;this.width=t.width;this.height=t.height;this.type=t.type;this.meta=t.meta;""===this.name&&(this.name=t.name);var w=!0}catch(z){this.trigger("error",z.code),w=!1}return w},999)}var y=["progress","load","error","resize","embedded"];m.MAX_RESIZE_WIDTH=8192;m.MAX_RESIZE_HEIGHT=8192;m.prototype=h.instance;return m});C("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(n,
q,f,g){var a={};f.addConstructor("html5",function(b,d,c){var e=this,h=f.capTest,l=f.capTrue;c=n.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return e.can("access_binary")&&!!a.Image},display_media:h((g.can("create_canvas")||g.can("use_data_uri_over32kb"))&&!!R["moxie/image/Image"]),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var k=document.createElement("div");return("draggable"in
k||"ondragstart"in k&&"ondrop"in k)&&("IE"!==g.browser||g.verComp(g.version,9,">"))}()),filter_by_extension:h(!("Chrome"===g.browser&&g.verComp(g.version,28,"<")||"IE"===g.browser&&g.verComp(g.version,10,"<")||"Safari"===g.browser&&g.verComp(g.version,7,"<")||"Firefox"===g.browser&&g.verComp(g.version,37,"<"))),return_response_headers:l,return_response_type:function(k){return"json"===k&&window.JSON?!0:g.can("return_response_type",k)},return_status_code:l,report_upload_progress:h(window.XMLHttpRequest&&
(new XMLHttpRequest).upload),resize_image:function(){return e.can("access_binary")&&g.can("create_canvas")},select_file:function(){return g.can("use_fileinput")&&window.File},select_folder:function(){return e.can("select_file")&&("Chrome"===g.browser&&g.verComp(g.version,21,">=")||"Firefox"===g.browser&&g.verComp(g.version,42,">="))},select_multiple:function(){return e.can("select_file")&&!("Safari"===g.browser&&"Windows"===g.os)&&!("iOS"===g.os&&g.verComp(g.osVersion,"7.0.0",">")&&g.verComp(g.osVersion,
"8.0.0","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||e.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return e.can("slice_blob")&&e.can("send_multipart")},summon_file_dialog:function(){return e.can("select_file")&&
!("Firefox"===g.browser&&g.verComp(g.version,4,"<")||"Opera"===g.browser&&g.verComp(g.version,12,"<")||"IE"===g.browser&&g.verComp(g.version,10,"<"))},upload_filesize:l,use_http_method:l},c);f.call(this,b,d||"html5",c);n.extend(this,{init:function(){this.trigger("Init")},destroy:function(k){return function(){k.call(e);k=e=null}}(this.destroy)});n.extend(this.getShim(),a)});return a});C("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(n,q){return n.Blob=function(){function f(g,
a,b){var d;if(window.File.prototype.slice)try{return g.slice(),g.slice(a,b)}catch(c){return g.slice(a,b-a)}else return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(g,a,b):null}this.slice=function(){return new q(this.getRuntime().uid,f.apply(this,arguments))};this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}});C("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(n){function q(){this.returnValue=!1}function f(){this.cancelBubble=
!0}var g={},a="moxie_"+n.guid(),b=function(d,c,e){c=c.toLowerCase();if(d[a]&&g[d[a]]&&g[d[a]][c]){var h=g[d[a]][c];for(var l=h.length-1;0<=l;l--)if(h[l].orig===e||h[l].key===e)if(d.removeEventListener?d.removeEventListener(c,h[l].func,!1):d.detachEvent&&d.detachEvent("on"+c,h[l].func),h[l].orig=null,h[l].func=null,h.splice(l,1),void 0!==e)break;h.length||delete g[d[a]][c];if(n.isEmptyObj(g[d[a]])){delete g[d[a]];try{delete d[a]}catch(k){d[a]=void 0}}}};return{addEvent:function(d,c,e,h){c=c.toLowerCase();
if(d.addEventListener){var l=e;d.addEventListener(c,l,!1)}else d.attachEvent&&(l=function(){var k=window.event;k.target||(k.target=k.srcElement);k.preventDefault=q;k.stopPropagation=f;e(k)},d.attachEvent("on"+c,l));d[a]||(d[a]=n.guid());g.hasOwnProperty(d[a])||(g[d[a]]={});d=g[d[a]];d.hasOwnProperty(c)||(d[c]=[]);d[c].push({func:l,orig:e,key:h})},removeEvent:b,removeAllEvents:function(d,c){d&&d[a]&&n.each(g[d[a]],function(e,h){b(d,h,c)})}}});C("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(n,q,f,g,a,b,d){return n.FileInput=function(){var c,e;f.extend(this,{init:function(h){var l=this,k=l.getRuntime(),p;c=h;h=b.extList2mimes(c.accept,k.can("filter_by_extension"));var m=k.getShimContainer();m.innerHTML='<input id="'+k.uid+'" type="file" style="font-size:999px;opacity:0;"'+(c.multiple&&k.can("select_multiple")?"multiple":"")+(c.directory&&k.can("select_folder")?"webkitdirectory directory":"")+(h?' accept="'+h.join(",")+'"':"")+" />";h=g.get(k.uid);f.extend(h.style,{position:"absolute",
top:0,left:0,width:"100%",height:"100%"});var y=g.get(c.browse_button);e=g.getStyle(y,"z-index")||"auto";k.can("summon_file_dialog")&&("static"===g.getStyle(y,"position")&&(y.style.position="relative"),a.addEvent(y,"click",function(r){var u=g.get(k.uid);u&&!u.disabled&&u.click();r.preventDefault()},l.uid),l.bind("Refresh",function(){p=parseInt(e,10)||1;g.get(c.browse_button).style.zIndex=p;this.getRuntime().getShimContainer().style.zIndex=p-1}));m=k.can("summon_file_dialog")?y:m;a.addEvent(m,"mouseover",
function(){l.trigger("mouseenter")},l.uid);a.addEvent(m,"mouseout",function(){l.trigger("mouseleave")},l.uid);a.addEvent(m,"mousedown",function(){l.trigger("mousedown")},l.uid);a.addEvent(g.get(c.container),"mouseup",function(){l.trigger("mouseup")},l.uid);(k.can("summon_file_dialog")?h:y).setAttribute("tabindex",-1);h.onchange=function u(){l.files=[];f.each(this.files,function(x){var t="";if(c.directory&&"."==x.name)return!0;x.webkitRelativePath&&(t="/"+x.webkitRelativePath.replace(/^\//,""));x=
new q(k.uid,x);x.relativePath=t;l.files.push(x)});if("IE"!==d.browser&&"IEMobile"!==d.browser)this.value="";else{var v=this.cloneNode(!0);this.parentNode.replaceChild(v,this);v.onchange=u}l.files.length&&l.trigger("change")};l.trigger({type:"ready",async:!0});m=null},setOption:function(h,l){var k=this.getRuntime(),p=g.get(k.uid);switch(h){case "accept":l?(h=l.mimes||b.extList2mimes(l,k.can("filter_by_extension")),p.setAttribute("accept",h.join(","))):p.removeAttribute("accept");break;case "directory":l&&
k.can("select_folder")?(p.setAttribute("directory",""),p.setAttribute("webkitdirectory","")):(p.removeAttribute("directory"),p.removeAttribute("webkitdirectory"));break;case "multiple":l&&k.can("select_multiple")?p.setAttribute("multiple",""):p.removeAttribute("multiple")}},disable:function(h){var l=this.getRuntime();if(l=g.get(l.uid))l.disabled=!!h},destroy:function(){var h=this.getRuntime(),l=h.getShim();h=h.getShimContainer();var k=c&&g.get(c.container),p=c&&g.get(c.browse_button);k&&a.removeAllEvents(k,
this.uid);p&&(a.removeAllEvents(p,this.uid),p.style.zIndex=e);h&&(a.removeAllEvents(h,this.uid),h.innerHTML="");l.removeInstance(this.uid);c=null}})}});C("moxie/runtime/html5/file/FileDrop","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime".split(" "),function(n,q,f,g,a,b){return n.FileDrop=function(){function d(v){if(!v.dataTransfer||!v.dataTransfer.types)return!1;v=f.toArray(v.dataTransfer.types||[]);return-1!==
f.inArray("Files",v)||-1!==f.inArray("public.file-url",v)||-1!==f.inArray("application/x-moz-file",v)}function c(v,x){if(y.length){var t=b.getFileExtension(v.name);t=!t||-1!==f.inArray(t,y)}else t=!0;t&&(v=new q(u,v),v.relativePath=x||"",m.push(v))}function e(v){for(var x=[],t=0;t<v.length;t++)[].push.apply(x,v[t].extensions.split(/\s*,\s*/));return-1===f.inArray("*",x)?x:[]}function h(v,x){var t=[];f.each(v,function(w){var z=w.webkitGetAsEntry();z&&(z.isFile?c(w.getAsFile(),z.fullPath):t.push(z))});
t.length?l(t,x):x()}function l(v,x){var t=[];f.each(v,function(w){t.push(function(z){k(w,z)})});f.inSeries(t,function(){x()})}function k(v,x){v.isFile?v.file(function(t){c(t,v.fullPath);x()},function(){x()}):v.isDirectory?p(v,x):x()}function p(v,x){function t(B){z.readEntries(function(E){E.length?([].push.apply(w,E),t(B)):B()},B)}var w=[],z=v.createReader();t(function(){l(w,x)})}var m=[],y=[],r,u;f.extend(this,{init:function(v){var x=this;r=v;u=x.ruid;y=e(r.accept);v=r.container;a.addEvent(v,"dragover",
function(t){d(t)&&(t.preventDefault(),t.dataTransfer.dropEffect="copy")},x.uid);a.addEvent(v,"drop",function(t){d(t)&&(t.preventDefault(),m=[],t.dataTransfer.items&&t.dataTransfer.items[0].webkitGetAsEntry?h(t.dataTransfer.items,function(){x.files=m;x.trigger("drop")}):(f.each(t.dataTransfer.files,function(w){c(w)}),x.files=m,x.trigger("drop")))},x.uid);a.addEvent(v,"dragenter",function(t){x.trigger("dragenter")},x.uid);a.addEvent(v,"dragleave",function(t){x.trigger("dragleave")},x.uid)},destroy:function(){a.removeAllEvents(r&&
g.get(r.container),this.uid);u=m=y=r=null;this.getRuntime().getShim().removeInstance(this.uid)}})}});C("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(n,q,f){return n.FileReader=function(){var g,a=!1;f.extend(this,{read:function(b,d){var c=this;c.result="";g=new window.FileReader;g.addEventListener("progress",function(e){c.trigger(e)});g.addEventListener("load",function(e){if(a){var h=g.result;h=q.atob(h.substring(h.indexOf("base64,")+
7))}else h=g.result;c.result=h;c.trigger(e)});g.addEventListener("error",function(e){c.trigger(e,g.error)});g.addEventListener("loadend",function(e){g=null;c.trigger(e)});"function"===f.typeOf(g[b])?(a=!1,g[b](d.getSource())):"readAsBinaryString"===b&&(a=!0,g.readAsDataURL(d.getSource()))},abort:function(){g&&g.abort()},destroy:function(){g=null;this.getRuntime().getShim().removeInstance(this.uid)}})}});C("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),
function(n,q,f,g,a,b,d,c,e){return n.XMLHttpRequest=function(){function h(r,u){var v=this;var x=u.getBlob().getSource();var t=new window.FileReader;t.onload=function(){u.append(u.getBlobName(),new b(null,{type:x.type,data:t.result}));p.send.call(v,r,u)};t.readAsBinaryString(x)}function l(){if(!window.XMLHttpRequest||"IE"===e.browser&&e.verComp(e.version,8,"<")){a:{for(var r=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],u=0;u<r.length;u++)try{var v=new ActiveXObject(r[u]);break a}catch(x){}v=void 0}return v}return new window.XMLHttpRequest}
function k(r){var u="----moxieboundary"+(new Date).getTime(),v="";if(!this.getRuntime().can("send_binary_string"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);m.setRequestHeader("Content-Type","multipart/form-data; boundary="+u);r.each(function(x,t){v=x instanceof b?v+("--"+u+'\r\nContent-Disposition: form-data; name="'+t+'"; filename="'+unescape(encodeURIComponent(x.name||"blob"))+'"\r\nContent-Type: '+(x.type||"application/octet-stream")+"\r\n\r\n"+x.getSource()+"\r\n"):v+("--"+u+
'\r\nContent-Disposition: form-data; name="'+t+'"\r\n\r\n'+unescape(encodeURIComponent(x))+"\r\n")});return v+="--"+u+"--\r\n"}var p=this,m,y;q.extend(this,{send:function(r,u){var v=this,x="Mozilla"===e.browser&&e.verComp(e.version,4,">=")&&e.verComp(e.version,7,"<"),t="Android Browser"===e.browser,w=!1;y=r.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();m=l();m.open(r.method,r.url,r.async,r.user,r.password);if(u instanceof b)u.isDetached()&&(w=!0),u=u.getSource();else if(u instanceof d){if(u.hasBlob())if(u.getBlob().isDetached())u=
k.call(v,u),w=!0;else if((x||t)&&"blob"===q.typeOf(u.getBlob().getSource())&&window.FileReader){h.call(v,r,u);return}if(u instanceof d){var z=new window.FormData;u.each(function(B,E){B instanceof b?z.append(E,B.getSource()):z.append(E,B)});u=z}}m.upload?(r.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(B){v.trigger(B)}),m.addEventListener("error",function(B){v.trigger(B)}),m.addEventListener("progress",function(B){v.trigger(B)}),m.upload.addEventListener("progress",function(B){v.trigger({type:"UploadProgress",
loaded:B.loaded,total:B.total})})):m.onreadystatechange=function(){switch(m.readyState){case 3:var B;try{if(g.hasSameOrigin(r.url)&&(B=m.getResponseHeader("Content-Length")||0),m.responseText)var E=m.responseText.length}catch(A){B=E=0}v.trigger({type:"progress",lengthComputable:!!B,total:parseInt(B,10),loaded:E});break;case 4:m.onreadystatechange=function(){};try{if(200<=m.status&&400>m.status){v.trigger("load");break}}catch(A){}v.trigger("error")}};q.isEmptyObj(r.headers)||q.each(r.headers,function(B,
E){m.setRequestHeader(E,B)});""!==r.responseType&&"responseType"in m&&("json"!==r.responseType||e.can("return_response_type","json")?m.responseType=r.responseType:m.responseType="text");w?m.sendAsBinary?m.sendAsBinary(u):function(){for(var B=new Uint8Array(u.length),E=0;E<u.length;E++)B[E]=u.charCodeAt(E)&255;m.send(B.buffer)}():m.send(u);v.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(r){}return 0},getResponse:function(r){var u=this.getRuntime();try{switch(r){case "blob":var v=
new a(u.uid,m.response),x=m.getResponseHeader("Content-Disposition");if(x){var t=x.match(/filename=(['"'])([^\1]+)\1/);t&&(y=t[2])}v.name=y;v.type||(v.type=f.getFileMime(y));return v;case "json":return e.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case "document":var w=m.responseXML,z=m.responseText;"IE"===e.browser&&z&&w&&!w.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(m.getResponseHeader("Content-Type"))&&(w=new window.ActiveXObject("Microsoft.XMLDOM"),
w.async=!1,w.validateOnParse=!1,w.loadXML(z));var B=w&&("IE"===e.browser&&0!==w.parseError||!w.documentElement||"parsererror"===w.documentElement.tagName)?null:w;return B;default:return""!==m.responseText?m.responseText:null}}catch(E){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(r){}return""},abort:function(){m&&m.abort()},destroy:function(){p=y=null;this.getRuntime().getShim().removeInstance(this.uid)}})}});C("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],
function(n){function q(a){a instanceof ArrayBuffer?f.apply(this,arguments):g.apply(this,arguments)}function f(a){var b=new DataView(a);n.extend(this,{readByteAt:function(d){return b.getUint8(d)},writeByteAt:function(d,c){b.setUint8(d,c)},SEGMENT:function(d,c,e){switch(arguments.length){case 2:return a.slice(d,d+c);case 1:return a.slice(d);case 3:if(null===e&&(e=new ArrayBuffer),e instanceof ArrayBuffer){var h=new Uint8Array(this.length()-c+e.byteLength);0<d&&h.set(new Uint8Array(a.slice(0,d)),0);
h.set(new Uint8Array(e),d);h.set(new Uint8Array(a.slice(d+c)),d+e.byteLength);this.clear();a=h.buffer;b=new DataView(a);break}default:return a}},length:function(){return a?a.byteLength:0},clear:function(){b=a=null}})}function g(a){function b(d,c,e){e=3===arguments.length?e:a.length-c-1;a=a.substr(0,c)+d+a.substr(e+c)}n.extend(this,{readByteAt:function(d){return a.charCodeAt(d)},writeByteAt:function(d,c){b(String.fromCharCode(c),d,1)},SEGMENT:function(d,c,e){switch(arguments.length){case 1:return a.substr(d);
case 2:return a.substr(d,c);case 3:b(null!==e?e:"",d,c);break;default:return a}},length:function(){return a?a.length:0},clear:function(){a=null}})}n.extend(q.prototype,{littleEndian:!1,read:function(a,b){var d,c;if(a+b>this.length())throw Error("You are trying to read outside the source boundaries.");var e=this.littleEndian?0:-8*(b-1);for(d=c=0;c<b;c++)d|=this.readByteAt(a+c)<<Math.abs(e+8*c);return d},write:function(a,b,d){var c;if(a>this.length())throw Error("You are trying to write outside the source boundaries.");
var e=this.littleEndian?0:-8*(d-1);for(c=0;c<d;c++)this.writeByteAt(a+c,b>>Math.abs(e+8*c)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){a=this.read(a,4);return 2147483647<a?a-4294967296:a},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,b){return this.asArray("CHAR",a,b).join("")},asArray:function(a,b,d){for(var c=[],e=0;e<d;e++)c[e]=this[a](b+e);return c}});return q});
C("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(n,q){return function a(g){var b=[],d,c=0;g=new n(g);if(65496!==g.SHORT(0))throw g.clear(),new q.ImageError(q.ImageError.WRONG_FORMAT);for(d=2;d<=g.length();){var e=g.SHORT(d);if(65488<=e&&65495>=e)d+=2;else{if(65498===e||65497===e)break;c=g.SHORT(d+2)+2;65505<=e&&65519>=e&&b.push({hex:e,name:"APP"+(e&15),start:d,length:c,segment:g.SEGMENT(d,c)});d+=c}}g.clear();return{headers:b,restore:function(h){var l=
new n(h);d=65504==l.SHORT(2)?4+l.SHORT(4):2;var k=0;for(h=b.length;k<h;k++)l.SEGMENT(d,0,b[k].segment),d+=b[k].length;h=l.SEGMENT();l.clear();return h},strip:function(h){var l=new a(h);var k=l.headers;l.purge();l=new n(h);for(h=k.length;h--;)l.SEGMENT(k[h].start,k[h].length,"");h=l.SEGMENT();l.clear();return h},get:function(h){for(var l=[],k=0,p=b.length;k<p;k++)b[k].name===h.toUpperCase()&&l.push(b[k].segment);return l},set:function(h,l){var k=[],p,m;"string"===typeof l?k.push(l):k=l;l=p=0;for(m=
b.length;l<m&&!(b[l].name===h.toUpperCase()&&(b[l].segment=k[p],b[l].length=k[p].length,p++),p>=k.length);l++);},purge:function(){this.headers=b=[]}}}});C("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(n,q,f){function g(a){function b(p,m){var y,r={},u={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},v={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,
SRATIONAL:8};var x=this.SHORT(p);for(y=0;y<x;y++){var t=p+2+12*y;var w=m[this.SHORT(t)];if(w!==S){var z=u[this.SHORT(t+=2)];var B=this.LONG(t+=2);var E=v[z];if(!E)throw new f.ImageError(f.ImageError.INVALID_META_ERR);t+=4;4<E*B&&(t=this.LONG(t)+e.tiffHeader);if(t+E*B>=this.length())throw new f.ImageError(f.ImageError.INVALID_META_ERR);"ASCII"===z?r[w]=n.trim(this.STRING(t,B).replace(/\0$/,"")):(z=this.asArray(z,t,B),B=1==B?z[0]:z,c.hasOwnProperty(w)&&"object"!=typeof B?r[w]=c[w][B]:r[w]=B)}}return r}
q.call(this,a);var d={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",
41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};var c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",
9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",
13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",
73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",
2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};var e={tiffHeader:10};var h=e.tiffHeader;var l={clear:this.clear};n.extend(this,{read:function(){try{return g.prototype.read.apply(this,
arguments)}catch(p){throw new f.ImageError(f.ImageError.INVALID_META_ERR);}},write:function(){try{return g.prototype.write.apply(this,arguments)}catch(p){throw new f.ImageError(f.ImageError.INVALID_META_ERR);}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(p){return this.LONG(p)/this.LONG(p+4)},SRATIONAL:function(p){return this.SLONG(p)/this.SLONG(p+4)},ASCII:function(p){return this.CHAR(p)},TIFF:function(){return k||null},EXIF:function(){var p=null;if(e.exifIFD){try{p=
b.call(this,e.exifIFD,d.exif)}catch(r){return null}if(p.ExifVersion&&"array"===n.typeOf(p.ExifVersion)){for(var m=0,y="";m<p.ExifVersion.length;m++)y+=String.fromCharCode(p.ExifVersion[m]);p.ExifVersion=y}}return p},GPS:function(){var p=null;if(e.gpsIFD){try{p=b.call(this,e.gpsIFD,d.gps)}catch(m){return null}p.GPSVersionID&&"array"===n.typeOf(p.GPSVersionID)&&(p.GPSVersionID=p.GPSVersionID.join("."))}return p},thumb:function(){if(e.IFD1)try{var p=b.call(this,e.IFD1,d.thumb);if("JPEGInterchangeFormat"in
p)return this.SEGMENT(e.tiffHeader+p.JPEGInterchangeFormat,p.JPEGInterchangeFormatLength)}catch(m){}return null},setExif:function(p,m){if("PixelXDimension"!==p&&"PixelYDimension"!==p)return!1;a:{var y=0;if("string"===typeof p){var r=d.exif;for(u in r)if(r[u]===p){p=u;break}}var u=e.exifIFD;r=this.SHORT(u);for(var v=0;v<r;v++){var x=u+12*v+2;if(this.SHORT(x)==p){y=x+8;break}}if(y){try{this.write(y,m,4)}catch(t){m=!1;break a}m=!0}else m=!1}return m},clear:function(){l.clear();a=d=c=k=e=l=null}});if(65505!==
this.SHORT(0)||"EXIF\x00"!==this.STRING(4,5).toUpperCase())throw new f.ImageError(f.ImageError.INVALID_META_ERR);this.littleEndian=18761==this.SHORT(h);if(42!==this.SHORT(h+=2))throw new f.ImageError(f.ImageError.INVALID_META_ERR);e.IFD0=e.tiffHeader+this.LONG(h+=2);var k=b.call(this,e.IFD0,d.tiff);"ExifIFDPointer"in k&&(e.exifIFD=e.tiffHeader+k.ExifIFDPointer,delete k.ExifIFDPointer);"GPSInfoIFDPointer"in k&&(e.gpsIFD=e.tiffHeader+k.GPSInfoIFDPointer,delete k.GPSInfoIFDPointer);n.isEmptyObj(k)&&
(k=null);if(h=this.LONG(e.IFD0+12*this.SHORT(e.IFD0)+2))e.IFD1=e.tiffHeader+h}g.prototype=q.prototype;return g});C("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(n,q,f,g,a){return function(b){function d(p){var m=0;for(p||(p=e);m<=p.length();){var y=p.SHORT(m+=2);if(65472<=y&&65475>=y)return m+=5,{height:p.SHORT(m),width:p.SHORT(m+2)};
y=p.SHORT(m+=2);m+=y-2}return null}function c(){var p=l.thumb();if(p){var m=new g(p);var y=d(m);m.clear();if(y)return y.data=p,y}return null}var e=new g(b);if(65496!==e.SHORT(0))throw new q.ImageError(q.ImageError.WRONG_FORMAT);var h=new f(b);try{var l=new a(h.get("app1")[0])}catch(p){}var k=d.call(this);n.extend(this,{type:"image/jpeg",size:e.length(),width:k&&k.width||0,height:k&&k.height||0,setExif:function(p,m){if(!l)return!1;"object"===n.typeOf(p)?n.each(p,function(y,r){l.setExif(r,y)}):l.setExif(p,
m);h.set("app1",l.SEGMENT())},writeHeaders:function(){return arguments.length?h.restore(arguments[0]):h.restore(b)},stripHeaders:function(p){return h.strip(p)},purge:function(){l&&h&&e&&(l.clear(),h.purge(),e.clear(),k=h=l=e=null)}});l&&(this.meta={tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS(),thumb:c()})}});C("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(n,q,f){return function(g){function a(){b&&(b.clear(),g=d=b=null)}
var b=new f(g);(function(){var c=0,e,h=[35152,20039,3338,6666];for(e=0;e<h.length;e++,c+=2)if(h[e]!=b.SHORT(c))throw new n.ImageError(n.ImageError.WRONG_FORMAT);})();var d=function(){var c=8;var e=b.LONG(c);var h=b.STRING(c+=4,4);var l=c+=4;b.LONG(c+e);return"IHDR"==h?{width:b.LONG(l),height:b.LONG(l+4)}:null}.call(this);q.extend(this,{type:"image/png",size:b.length(),width:d.width,height:d.height,purge:function(){a.call(this)}});a.call(this)}});C("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(n,q,f,g){return function(a){var b=[f,g];var d=function(){for(var c=0;c<b.length;c++)try{return new b[c](a)}catch(e){}throw new q.ImageError(q.ImageError.WRONG_FORMAT);}();n.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(c){return c},stripHeaders:function(c){return c},purge:function(){a=null}});n.extend(this,d);this.purge=function(){d.purge();d=null}}});C("moxie/runtime/html5/image/ResizerCanvas",
[],function(){function n(q,f,g){var a=q.width>q.height?"width":"height",b=Math.round(q[a]*f),d=!1;"nearest"!==g&&(.5>f||2<f)&&(f=.5>f?.5:2,d=!0);var c=q.width,e=q.height,h=Math.round(c*f);f=Math.round(e*f);var l=document.createElement("canvas");l.width=h;l.height=f;l.getContext("2d").drawImage(q,0,0,c,e,0,0,h,f);return d?n(l,b/l[a],g):l}return{scale:n}});C("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/ResizerCanvas moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(n,q,f,g,a,b,d,c,e,h){return n.Image=function(){function l(){if(!t&&!v)throw new f.ImageError(f.DOMException.INVALID_STATE_ERR);return t||v}function k(){var A=l();if("canvas"==A.nodeName.toLowerCase())return A;t=document.createElement("canvas");t.width=A.width;t.height=A.height;t.getContext("2d").drawImage(A,0,0);return t}function p(A){return g.atob(A.substring(A.indexOf("base64,")+7))}function m(A){var F=this;v=new Image;v.onerror=function(){r.call(this);F.trigger("error",f.ImageError.WRONG_FORMAT)};
v.onload=function(){F.trigger("load")};v.src="data:"==A.substr(0,5)?A:"data:"+(z.type||"")+";base64,"+g.btoa(A)}function y(A,F){var K=this;if(window.FileReader){var H=new FileReader;H.onload=function(){F.call(K,this.result)};H.onerror=function(){K.trigger("error",f.ImageError.WRONG_FORMAT)};H.readAsDataURL(A)}else return F.call(this,A.getAsDataURL())}function r(){x&&(x.purge(),x=null);w=v=t=z=null;B=!1}var u=this,v,x,t,w,z,B=!1,E=!0;q.extend(this,{loadFromBlob:function(A){var F=this.getRuntime(),
K=1<arguments.length?arguments[1]:!0;if(!F.can("access_binary"))throw new f.RuntimeError(f.RuntimeError.NOT_SUPPORTED_ERR);z=A;A.isDetached()?(w=A.getSource(),m.call(this,w)):y.call(this,A.getSource(),function(H){K&&(w=p(H));m.call(this,H)})},loadFromImage:function(A,F){this.meta=A.meta;z=new b(null,{name:A.name,size:A.size,type:A.type});m.call(this,F?w=A.getAsBinaryString():A.getAsDataURL())},getInfo:function(){var A=this.getRuntime();!x&&w&&A.can("access_image_binary")&&(x=new d(w));A={width:l().width||
0,height:l().height||0,type:z.type||e.getFileMime(z.name),size:w&&w.length||z.size||0,name:z.name||"",meta:null};E&&(A.meta=x&&x.meta||this.meta||{},!A.meta||!A.meta.thumb||A.meta.thumb.data instanceof a||(A.meta.thumb.data=new a(null,{type:"image/jpeg",data:A.meta.thumb.data})));return A},resize:function(A,F,K){var H=document.createElement("canvas");H.width=A.width;H.height=A.height;H.getContext("2d").drawImage(l(),A.x,A.y,A.width,A.height,0,0,H.width,H.height);t=c.scale(H,F);E=K.preserveHeaders;
if(!E){A=t;F=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;K=Math.PI/180;H=document.createElement("canvas");var I=H.getContext("2d"),M=A.width,P=A.height;-1<q.inArray(F,[5,6,7,8])?(H.width=P,H.height=M):(H.width=M,H.height=P);switch(F){case 2:I.translate(M,0);I.scale(-1,1);break;case 3:I.translate(M,P);I.rotate(180*K);break;case 4:I.translate(0,P);I.scale(1,-1);break;case 5:I.rotate(90*K);I.scale(1,-1);break;case 6:I.rotate(90*K);I.translate(0,-P);break;case 7:I.rotate(90*K);I.translate(M,
-P);I.scale(-1,1);break;case 8:I.rotate(-90*K),I.translate(-M,0)}I.drawImage(A,0,0,M,P);t=H}this.width=t.width;this.height=t.height;B=!0;this.trigger("Resize")},getAsCanvas:function(){t||(t=k());t.id=this.uid+"_canvas";return t},getAsBlob:function(A,F){return A!==this.type?(B=!0,new b(null,{name:z.name||"",type:A,data:u.getAsDataURL(A,F)})):new b(null,{name:z.name||"",type:A,data:u.getAsBinaryString(A,F)})},getAsDataURL:function(A,F){F=F||90;if(!B)return v.src;k();if("image/jpeg"!==A)return t.toDataURL("image/png");
try{return t.toDataURL("image/jpeg",F/100)}catch(K){return t.toDataURL("image/jpeg")}},getAsBinaryString:function(A,F){if(!B)return w||(w=p(u.getAsDataURL(A,F))),w;if("image/jpeg"!==A)w=p(u.getAsDataURL(A,F));else{F||(F=90);k();try{var K=t.toDataURL("image/jpeg",F/100)}catch(H){K=t.toDataURL("image/jpeg")}w=p(K);x&&(w=x.stripHeaders(w),E&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),w=x.writeHeaders(w)),x.purge(),x=null)}B=!1;return w},destroy:function(){u=
null;r.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});C("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(n,q,f,g,a){function b(){try{var e=navigator.plugins["Shockwave Flash"];e=e.description}catch(h){try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(l){e="0.0"}}e=e.match(/\d+/g);return parseFloat(e[0]+"."+e[1])}function d(e){var h=
f.get(e);h&&"OBJECT"==h.nodeName&&("IE"===q.browser?(h.style.display="none",function k(){if(4==h.readyState){var p=f.get(e);if(p){for(var m in p)"function"==typeof p[m]&&(p[m]=null);p.parentNode.removeChild(p)}}else setTimeout(k,10)}()):h.parentNode.removeChild(h))}var c={};a.addConstructor("flash",function(e){var h=this,l;e=n.extend({swf_url:q.swf_url},e);a.call(this,e,"flash",{access_binary:function(k){return k&&"browser"===h.mode},access_image_binary:function(k){return k&&"browser"===h.mode},display_media:a.capTest(!!R["moxie/image/Image"]),
do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===h.mode},resize_image:a.capTrue,return_response_headers:!1,return_response_type:function(k){return"json"===k&&window.JSON?!0:!n.arrayDiff(k,["","text","document"])||"browser"===h.mode},return_status_code:function(k){return"browser"===h.mode||!n.arrayDiff(k,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:function(k){return k&&"browser"===h.mode},send_browser_cookies:function(k){return k&&
"browser"===h.mode},send_custom_headers:function(k){return k&&"browser"===h.mode},send_multipart:a.capTrue,slice_blob:function(k){return k&&"browser"===h.mode},stream_upload:function(k){return k&&"browser"===h.mode},summon_file_dialog:!1,upload_filesize:function(k){return 2097152>=n.parseSizeStr(k)||"client"===h.mode},use_http_method:function(k){return!n.arrayDiff(k,["GET","POST"])}},{access_binary:function(k){return k?"browser":"client"},access_image_binary:function(k){return k?"browser":"client"},
report_upload_progress:function(k){return k?"browser":"client"},return_response_type:function(k){return n.arrayDiff(k,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(k){return n.arrayDiff(k,[200,404])?"browser":["client","browser"]},send_binary_string:function(k){return k?"browser":"client"},send_browser_cookies:function(k){return k?"browser":"client"},send_custom_headers:function(k){return k?"browser":"client"},slice_blob:function(k){return k?"browser":
"client"},stream_upload:function(k){return k?"client":"browser"},upload_filesize:function(k){return 2097152<=n.parseSizeStr(k)?"client":"browser"}},"client");11.3>b()&&(MXI_DEBUG&&q.debug.runtime&&q.log("\tFlash didn't meet minimal version requirement (11.3)."),this.mode=!1);n.extend(this,{getShim:function(){return f.get(this.uid)},shimExec:function(k,p){var m=[].slice.call(arguments,2);return h.getShim().exec(this.uid,k,p,m)},init:function(){var k=this.getShimContainer();n.extend(k.style,{position:"absolute",
top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});var p='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+e.swf_url+'" ';"IE"===q.browser&&(p+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');p+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+e.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+a.getGlobalEventTarget()+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';
if("IE"===q.browser){var m=document.createElement("div");k.appendChild(m);m.outerHTML=p;m=k=null}else k.innerHTML=p;l=setTimeout(function(){h&&!h.initialized&&(h.trigger("Error",new g.RuntimeError(g.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&q.debug.runtime&&q.log("\tFlash failed to initialize within a specified period of time (typically 5s)."))},5E3)},destroy:function(k){return function(){d(h.uid);k.call(h);clearTimeout(l);e=l=k=h=null}}(this.destroy)},c)});return c});C("moxie/runtime/flash/file/Blob",
["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(n,q){return n.Blob={slice:function(f,g,a,b){var d=this.getRuntime();0>g?g=Math.max(f.size+g,0):0<g&&(g=Math.min(g,f.size));0>a?a=Math.max(f.size+a,0):0<a&&(a=Math.min(a,f.size));(f=d.shimExec.call(this,"Blob","slice",g,a,b||""))&&(f=new q(d.uid,f));return f}}});C("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(n,q,f,g){return n.FileInput={init:function(a){var b=
this,d=this.getRuntime(),c=f.get(a.browse_button);c&&(c.setAttribute("tabindex",-1),c=null);this.bind("Change",function(){var e=d.shimExec.call(b,"FileInput","getFiles");b.files=[];g.each(e,function(h){b.files.push(new q(d.uid,h))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{accept:a.accept,multiple:a.multiple});this.trigger("ready")}}});C("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(n,q){function f(g,a){switch(a){case "readAsText":return q.atob(g,
"utf8");case "readAsBinaryString":return q.atob(g);case "readAsDataURL":return g}return null}return n.FileReader={read:function(g,a){var b=this;b.result="";"readAsDataURL"===g&&(b.result="data:"+(a.type||"")+";base64,");b.bind("Progress",function(d,c){c&&(b.result+=f(c,g))},999);return b.getRuntime().shimExec.call(this,"FileReader","readAsBase64",a.uid)}}});C("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(n,q){function f(g,a){switch(a){case "readAsText":return q.atob(g,
"utf8");case "readAsBinaryString":return q.atob(g);case "readAsDataURL":return g}return null}return n.FileReaderSync={read:function(g,a){var b=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",a.uid);if(!b)return null;"readAsDataURL"===g&&(b="data:"+(a.type||"")+";base64,"+b);return f(b,g,a.type)}}});C("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(n,q){return n.Transporter={getAsBlob:function(f){var g=this.getRuntime();return(f=
g.shimExec.call(this,"Transporter","getAsBlob",f))?new q(g.uid,f):null}}});C("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/runtime/flash/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter moxie/runtime/flash/runtime/Transporter".split(" "),function(n,q,f,g,a,b,d,c,e){return n.XMLHttpRequest={send:function(h,l){function k(){h.transport=r.mode;r.shimExec.call(y,"XMLHttpRequest",
"send",h,l)}function p(x,t){r.shimExec.call(y,"XMLHttpRequest","appendBlob",x,t.uid);l=null;k()}function m(x,t){var w=new c;w.bind("TransportingComplete",function(){t(this.result)});w.transport(x.getSource(),x.type,{ruid:r.uid})}var y=this,r=y.getRuntime();q.isEmptyObj(h.headers)||q.each(h.headers,function(x,t){r.shimExec.call(y,"XMLHttpRequest","setRequestHeader",t,x.toString())});if(l instanceof d){var u;l.each(function(x,t){x instanceof f?u=t:r.shimExec.call(y,"XMLHttpRequest","append",t,x)});
if(l.hasBlob()){var v=l.getBlob();v.isDetached()?m(v,function(x){v.destroy();p(u,x)}):p(u,v)}else l=null,k()}else l instanceof f?l.isDetached()?m(l,function(x){l.destroy();l=x.uid;k()}):(l=l.uid,k()):k()},getResponse:function(h){var l,k=this.getRuntime();if(l=k.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){l=new g(k.uid,l);if("blob"===h)return l;try{var p=new a;if(~q.inArray(h,["","text"]))return p.readAsText(l);if("json"===h&&window.JSON)return JSON.parse(p.readAsText(l))}finally{l.destroy()}}return null},
abort:function(h){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});C("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(n,q,f,g,a){return n.Image={loadFromBlob:function(b){function d(l){e.shimExec.call(c,"Image","loadFromBlob",l.uid);c=e=null}var c=this,e=c.getRuntime();if(b.isDetached()){var h=
new f;h.bind("TransportingComplete",function(){d(h.result.getSource())});h.transport(b.getSource(),b.type,{ruid:e.uid})}else d(b.getSource())},loadFromImage:function(b){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",b.uid)},getInfo:function(){var b=this.getRuntime(),d=b.shimExec.call(this,"Image","getInfo");d.meta&&d.meta.thumb&&d.meta.thumb.data&&!(b.meta.thumb.data instanceof g)&&(d.meta.thumb.data=new g(b.uid,d.meta.thumb.data));return d},getAsBlob:function(b,d){var c=this.getRuntime();
return(b=c.shimExec.call(this,"Image","getAsBlob",b,d))?new g(c.uid,b):null},getAsDataURL:function(){var b=this.getRuntime().Image.getAsBlob.apply(this,arguments);return b?(new a).readAsDataURL(b):null}}});C("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(n,q,f,g,a){function b(c){var e=!1,h=null,l,k,p=0;try{try{h=new ActiveXObject("AgControl.AgControl"),h.IsVersionSupported(c)&&(e=
!0)}catch(v){var m=navigator.plugins["Silverlight Plug-In"];if(m){var y=m.description;"1.0.30226.2"===y&&(y="2.0.30226.2");for(l=y.split(".");3<l.length;)l.pop();for(;4>l.length;)l.push(0);for(k=c.split(".");4<k.length;)k.pop();do{var r=parseInt(k[p],10);var u=parseInt(l[p],10);p++}while(p<k.length&&r===u);r<=u&&!isNaN(r)&&(e=!0)}}}catch(v){e=!1}return e}var d={};a.addConstructor("silverlight",function(c){var e=this,h;c=n.extend({xap_url:q.xap_url},c);a.call(this,c,"silverlight",{access_binary:a.capTrue,
access_image_binary:a.capTrue,display_media:a.capTest(!!R["moxie/image/Image"]),do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:a.capTrue,resize_image:a.capTrue,return_response_headers:function(l){return l&&"client"===e.mode},return_response_type:function(l){return"json"!==l?!0:!!window.JSON},return_status_code:function(l){return"client"===e.mode||!n.arrayDiff(l,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:a.capTrue,send_browser_cookies:function(l){return l&&
"browser"===e.mode},send_custom_headers:function(l){return l&&"client"===e.mode},send_multipart:a.capTrue,slice_blob:a.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:a.capTrue,use_http_method:function(l){return"client"===e.mode||!n.arrayDiff(l,["GET","POST"])}},{return_response_headers:function(l){return l?"client":"browser"},return_status_code:function(l){return n.arrayDiff(l,[200,404])?"client":["client","browser"]},send_browser_cookies:function(l){return l?"browser":"client"},send_custom_headers:function(l){return l?
"client":"browser"},use_http_method:function(l){return n.arrayDiff(l,["GET","POST"])?"client":["client","browser"]}});b("2.0.31005.0")&&"Opera"!==q.browser||(MXI_DEBUG&&q.debug.runtime&&q.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely)."),this.mode=!1);n.extend(this,{getShim:function(){return f.get(this.uid).content.Moxie},shimExec:function(l,k){var p=[].slice.call(arguments,2);return e.getShim().exec(this.uid,l,k,p)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+c.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+a.getGlobalEventTarget()+'"/></object>';h=setTimeout(function(){e&&!e.initialized&&(e.trigger("Error",new g.RuntimeError(g.RuntimeError.NOT_INIT_ERR)),
MXI_DEBUG&&q.debug.runtime&&q.log("Silverlight failed to initialize within a specified period of time (5-10s)."))},"Windows"!==q.OS?1E4:5E3)},destroy:function(l){return function(){l.call(e);clearTimeout(h);c=h=l=e=null}}(this.destroy)},d)});return d});C("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(n,q,f){return n.Blob=q.extend({},f)});C("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime",
"moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(n,q,f,g){function a(b){for(var d="",c=0;c<b.length;c++)d+=(""!==d?"|":"")+b[c].title+" | *."+b[c].extensions.replace(/,/g,";*.");return d}return n.FileInput={init:function(b){var d=this,c=this.getRuntime(),e=f.get(b.browse_button);e&&(e.setAttribute("tabindex",-1),e=null);this.bind("Change",function(){var h=c.shimExec.call(d,"FileInput","getFiles");d.files=[];g.each(h,function(l){d.files.push(new q(c.uid,l))})},999);c.shimExec.call(this,
"FileInput","init",a(b.accept),b.multiple);this.trigger("ready")},setOption:function(b,d){"accept"==b&&(d=a(d));this.getRuntime().shimExec.call(this,"FileInput","setOption",b,d)}}});C("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(n,q,f){return n.FileDrop={init:function(){var g=this.getRuntime();var a=g.getShimContainer();f.addEvent(a,"dragover",function(b){b.preventDefault();b.stopPropagation();b.dataTransfer.dropEffect=
"copy"},this.uid);f.addEvent(a,"dragenter",function(b){b.preventDefault();q.get(g.uid).dragEnter(b)&&b.stopPropagation()},this.uid);f.addEvent(a,"drop",function(b){b.preventDefault();q.get(g.uid).dragDrop(b)&&b.stopPropagation()},this.uid);return g.shimExec.call(this,"FileDrop","init")}}});C("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(n,q,f){return n.FileReader=q.extend({},f)});C("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(n,q,f){return n.FileReaderSync=q.extend({},f)});C("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(n,q,f){return n.Transporter=q.extend({},f)});C("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest",
"moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(n,q,f,g,a){return n.XMLHttpRequest=q.extend({},f)});C("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(n,q,f,g){return n.Image=q.extend({},g,{getInfo:function(){var a=this.getRuntime(),b=["tiff","exif","gps","thumb"],d={meta:{}},c=a.shimExec.call(this,"Image","getInfo");c.meta&&(q.each(b,
function(e){var h=c.meta[e],l,k;if(h&&h.keys){d.meta[e]={};var p=0;for(l=h.keys.length;p<l;p++){var m=h.keys[p];if(k=h[m])/^(\d|[1-9]\d+)$/.test(k)?k=parseInt(k,10):/^\d*\.\d+$/.test(k)&&(k=parseFloat(k)),d.meta[e][m]=k}}}),d.meta&&d.meta.thumb&&d.meta.thumb.data&&!(a.meta.thumb.data instanceof f)&&(d.meta.thumb.data=new f(a.uid,d.meta.thumb.data)));d.width=parseInt(c.width,10);d.height=parseInt(c.height,10);d.size=parseInt(c.size,10);d.type=c.type;d.name=c.name;return d},resize:function(a,b,d){this.getRuntime().shimExec.call(this,
"Image","resize",a.x,a.y,a.width,a.height,b,d.preserveHeaders,d.resample)}})});C("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(n,q,f,g){var a={};f.addConstructor("html4",function(b){var d=this,c=f.capTest,e=f.capTrue;f.call(this,b,"html4",{access_binary:c(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:c((g.can("create_canvas")||g.can("use_data_uri_over32kb"))&&!!R["moxie/image/Image"]),
do_cors:!1,drag_and_drop:!1,filter_by_extension:c(!("Chrome"===g.browser&&g.verComp(g.version,28,"<")||"IE"===g.browser&&g.verComp(g.version,10,"<")||"Safari"===g.browser&&g.verComp(g.version,7,"<")||"Firefox"===g.browser&&g.verComp(g.version,37,"<"))),resize_image:function(){return a.Image&&d.can("access_binary")&&g.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(h){return"json"===h&&window.JSON?!0:!!~n.inArray(h,["text","document",""])},return_status_code:function(h){return!n.arrayDiff(h,
[200,404])},select_file:function(){return g.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return d.can("select_file")},summon_file_dialog:function(){return d.can("select_file")&&!("Firefox"===g.browser&&g.verComp(g.version,4,"<")||"Opera"===g.browser&&g.verComp(g.version,12,"<")||"IE"===g.browser&&g.verComp(g.version,10,"<"))},upload_filesize:e,use_http_method:function(h){return!n.arrayDiff(h,["GET","POST"])}});
n.extend(this,{init:function(){this.trigger("Init")},destroy:function(h){return function(){h.call(d);h=d=null}}(this.destroy)});n.extend(this.getShim(),a)});return a});C("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(n,q,f,g,a,b,d){return n.FileInput=function(){function c(){var p=this,m=p.getRuntime(),y;var r=f.guid("uid_");var u=m.getShimContainer();
e&&(y=g.get(e+"_form"))&&(f.extend(y.style,{top:"100%"}),y.firstChild.setAttribute("tabindex",-1));var v=document.createElement("form");v.setAttribute("id",r+"_form");v.setAttribute("method","post");v.setAttribute("enctype","multipart/form-data");v.setAttribute("encoding","multipart/form-data");f.extend(v.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});var x=document.createElement("input");x.setAttribute("id",r);x.setAttribute("type","file");x.setAttribute("accept",
h.join(","));m.can("summon_file_dialog")&&x.setAttribute("tabindex",-1);f.extend(x.style,{fontSize:"999px",opacity:0});v.appendChild(x);u.appendChild(v);f.extend(x.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===d.browser&&d.verComp(d.version,10,"<")&&f.extend(x.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});x.onchange=function(){if(this.value){var t=this.files?this.files[0]:{name:this.value};t=new q(m.uid,t);this.onchange=function(){};c.call(p);p.files=
[t];x.setAttribute("id",t.uid);v.setAttribute("id",t.uid+"_form");p.trigger("change");x=v=null}};m.can("summon_file_dialog")&&(u=g.get(l.browse_button),a.removeEvent(u,"click",p.uid),a.addEvent(u,"click",function(t){x&&!x.disabled&&x.click();t.preventDefault()},p.uid));e=r;u=y=u=null}var e,h=[],l,k;f.extend(this,{init:function(p){var m=this,y=m.getRuntime();l=p;h=b.extList2mimes(p.accept,y.can("filter_by_extension"));var r=y.getShimContainer();(function(){var u;var v=g.get(p.browse_button);k=g.getStyle(v,
"z-index")||"auto";y.can("summon_file_dialog")?("static"===g.getStyle(v,"position")&&(v.style.position="relative"),m.bind("Refresh",function(){u=parseInt(k,10)||1;g.get(l.browse_button).style.zIndex=u;this.getRuntime().getShimContainer().style.zIndex=u-1})):v.setAttribute("tabindex",-1);v=y.can("summon_file_dialog")?v:r;a.addEvent(v,"mouseover",function(){m.trigger("mouseenter")},m.uid);a.addEvent(v,"mouseout",function(){m.trigger("mouseleave")},m.uid);a.addEvent(v,"mousedown",function(){m.trigger("mousedown")},
m.uid);a.addEvent(g.get(p.container),"mouseup",function(){m.trigger("mouseup")},m.uid);v=null})();c.call(this);r=null;m.trigger({type:"ready",async:!0})},setOption:function(p,m){var y=this.getRuntime();"accept"==p&&(h=m.mimes||b.extList2mimes(m,y.can("filter_by_extension")));(p=g.get(e))&&p.setAttribute("accept",h.join(","))},disable:function(p){var m;if(m=g.get(e))m.disabled=!!p},destroy:function(){var p=this.getRuntime(),m=p.getShim();p=p.getShimContainer();var y=l&&g.get(l.container),r=l&&g.get(l.browse_button);
y&&a.removeAllEvents(y,this.uid);r&&(a.removeAllEvents(r,this.uid),r.style.zIndex=k);p&&(a.removeAllEvents(p,this.uid),p.innerHTML="");m.removeInstance(this.uid);e=h=l=null}})}});C("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(n,q){return n.FileReader=q});C("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),
function(n,q,f,g,a,b,d,c){return n.XMLHttpRequest=function(){function e(p){var m=this,y,r=!1;if(k){var u=k.id.replace(/_iframe$/,"");if(u=f.get(u+"_form")){var v=u.getElementsByTagName("input");for(y=v.length;y--;)switch(v[y].getAttribute("type")){case "hidden":v[y].parentNode.removeChild(v[y]);break;case "file":r=!0}v=[];r||u.parentNode.removeChild(u);u=null}setTimeout(function(){b.removeEvent(k,"load",m.uid);k.parentNode&&k.parentNode.removeChild(k);var x=m.getRuntime().getShimContainer();x.children.length||
x.parentNode.removeChild(x);k=null;p()},1)}}var h,l,k;q.extend(this,{send:function(p,m){var y=this,r=y.getRuntime();h=l=null;if(m instanceof c&&m.hasBlob()){var u=m.getBlob();var v=u.uid;var x=f.get(v);var t=f.get(v+"_form");if(!t)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);}else v=q.guid("uid_"),t=document.createElement("form"),t.setAttribute("id",v+"_form"),t.setAttribute("method",p.method),t.setAttribute("enctype","multipart/form-data"),t.setAttribute("encoding","multipart/form-data"),
r.getShimContainer().appendChild(t);t.setAttribute("target",v+"_iframe");m instanceof c&&m.each(function(w,z){if(w instanceof d)x&&x.setAttribute("name",z);else{var B=document.createElement("input");q.extend(B,{type:"hidden",name:z,value:w});x?t.insertBefore(B,x):t.appendChild(B)}});t.setAttribute("action",p.url);(function(){var w=r.getShimContainer()||document.body,z=document.createElement("div");z.innerHTML='<iframe id="'+v+'_iframe" name="'+v+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';
k=z.firstChild;w.appendChild(k);b.addEvent(k,"load",function(){try{var B=k.contentWindow.document||k.contentDocument||window.frames[k.id].document;/^4(0[0-9]|1[0-7]|2[2346])\s/.test(B.title)?h=B.title.replace(/^(\d+).*$/,"$1"):(h=200,l=q.trim(B.body.innerHTML),y.trigger({type:"progress",loaded:l.length,total:l.length}),u&&y.trigger({type:"uploadprogress",loaded:u.size||1025,total:u.size||1025}))}catch(E){if(g.hasSameOrigin(p.url))h=404;else{e.call(y,function(){y.trigger("error")});return}}e.call(y,
function(){y.trigger("load")})},y.uid)})();t.submit();y.trigger("loadstart")},getStatus:function(){return h},getResponse:function(p){if("json"===p&&"string"===q.typeOf(l)&&window.JSON)try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(m){return null}return l},abort:function(){var p=this;k&&k.contentWindow&&(k.contentWindow.stop?k.contentWindow.stop():k.contentWindow.document.execCommand?k.contentWindow.document.execCommand("Stop"):k.src="about:blank");e.call(this,
function(){p.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}});C("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(n,q){return n.Image=q});(function(n){for(var q=0;q<n.length;q++){for(var f=X,g=n[q],a=g.split(/[.\/]/),b=0;b<a.length-1;++b)f[a[b]]===S&&(f[a[b]]={}),f=f[a[b]];f[a[a.length-1]]=R[g]}})("moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/utils/Env moxie/core/Exceptions moxie/core/utils/Dom moxie/core/EventTarget moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/core/I18n moxie/core/utils/Mime moxie/file/FileInput moxie/file/File moxie/file/FileDrop moxie/file/FileReader moxie/core/utils/Url moxie/runtime/RuntimeTarget moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/image/Image moxie/core/utils/Events moxie/runtime/html5/image/ResizerCanvas".split(" "))})(this)});
