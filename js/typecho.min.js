(function(a){a.Typecho={insertFileToEditor:function(b,c,d){},editorResize:function(b,c){$("#"+b).resizeable({minHeight:100,afterResize:function(d){$.post(c,{size:d})}})},uploadComplete:function(b){}}})(window);
function scrollableEditor(a,b){function c(m){var g=a.val().split("\n"),r=0;A.width(a.width());y=[];for(var n=0;n<g.length;n++)A.text(g[n]),r+=A.height(),y.push(r);A.html("");f(m)}function d(m){var g=a.height();g=(a.innerHeight()-g)/2;var r=a.scrollTop()-g,n=b.scrollTop();g=0;var x=null;if("undefined"!=typeof m)for(g=0;g<v.length;g++){if(r=v[g],m>=r[0]&&m<=r[1]){(g==v.length-1||r[2]<n||v[g+1][2]>n+b.height())&&b.scrollTop(r[2]);break}}else{for(m=0;m<t.length;m++)if(x=t[m],r<=x[2]){g=(r-x[3])*x[4]/
(x[2]-x[3]);break}if(x)for(n=0;n<v.length;n++)if(r=v[n],x[0]>=r[0]&&x[1]<=r[1]){x=v[n+1]?v[n+1][2]:b.get(0).scrollHeight;m=(0==m?0:r[2])+(x-r[2])*g;b.scrollTop(m);break}}}function f(m){var g=0;v=[];t=[];$(".line",b).each(function(){var n=$(this),x=n.data("start"),u=n.data("end"),D=n.data("start-original");n=n.position().top+b.scrollTop();v.push([x,u,n,this]);"undefined"!=typeof D?(t.push([x,D-1,y[D-1],g,0]),t.push([D,u,y[u],y[D-1],1])):t.push([x,u,y[u],g,1]);g=y[u]});var r=h();m?null!==r&&d(r):d()}
function e(m){m=$(m);var g=m.parent();return 0<m.length&&m.prop("tagName").match(/^(hr|tr)$/i)?m:0<g.length&&"div"==g.prop("tagName").toLowerCase()?m.next():g}function h(){var m=a.val(),g=a.getSelection().start,r=0,n=0,x=null;if(!E)return x;for(;;)if(r=m.indexOf("\n",r),0<=r&&r<g)n++,r+=1;else break;for(m=0;m<v.length;m++)if(g=v[m],n>=g[0]&&n<=g[1]){e(C).removeClass("focus");e(g[3]).addClass("focus");C=g[3];x=n;break}return x}var l=a.css(),z=a.width(),C=null,t=[],y=[],v=[],F={display:"block",position:"absolute",
left:"-99999px",top:"-99999px"},A=$("<div></div>").appendTo(document.body),E=!1;for(k in l)k.match(/^(direction|font-family|font-size|font-style|font-weight|letter-spacing|line-height|text-align|vertical-align|white-space|word-wrap|word-break|word-spacing)$/i)&&(F[k]=l[k]);A.css(F);A.css("min-height",F["line-height"]);setInterval(function(){a.width()!=z&&(z=a.width(),a.trigger("resize"))},150);a.on("touch keypress click",h);a.on("focus",function(){E=!0}).on("blur",function(){E=!1;e(C).removeClass("focus")});
a.on("resize",c);a.on("DOMMouseScroll mousewheel touchmove",function(){d()});b.on("DOMMouseScroll mousewheel touchmove",function(){var m=a.height();m=(a.innerHeight()-m)/2;var g=b.scrollTop(),r=!1;if(!(0>=v.length)){for(var n=0;n<v.length;n++)if(g<v[n][2]){r=!0;break}var x=r?v[0<n?n-1:0]:v[v.length-1];var u=0<x[0]?y[x[0]-1]:0,D=y[x[1]];r=r?v[0<n?n:1][2]:b.get(0).scrollHeight;a.scrollTop(u+(g-x[2])/(r-x[2])*(D-u)+m)}});return c}
(function(a){a.fn.dropdownMenu=function(b){this.each(function(){var c=this,d=a.extend({menuEl:null,btnEl:null},b);a(d.btnEl,c).click(function(){a(this).toggleClass("active");a(d.menuEl,c).toggle();return!1})})};a.fn.resizeable=function(b){var c=a.extend({minHeight:100,afterResize:null},b);return this.each(function(){function d(t){var y=t.clientY+document.documentElement.scrollTop,v=h+y;l>=y&&(v-=5);l=y;v=Math.max(z,v);textarea.height(v+"px");v<z&&f(t);return!1}function f(t){t=textarea.outerHeight();
a(document).unbind("mousemove",d).unbind("mouseup",f);textarea.css("opacity",1);textarea.focus();h=textarea=null;l=0;c.afterResize&&c.afterResize.call(C,t)}var e=a('<span class="resize"><i></i></span>').insertAfter(this),h,l=0,z=c.minHeight,C=this;e.bind("mousedown",{el:this},function(t){textarea=a(t.data.el);textarea.blur();l=t.clientY+document.documentElement.scrollTop;h=textarea.height()-l;textarea.css("opacity",.25);a(document).mousemove(d).mouseup(f);return!1})})};a.fn.tableSelectable=function(b){function c(e){e=
a(e);var h=a(f.checkEl,e),l=h.prop("checked");h.length&&(h.prop("checked",!l),l?e.removeClass("checked"):e.addClass("checked"))}var d=this,f=a.extend({checkEl:null,rowEl:null,selectAllEl:null,actionEl:null},b);a(f.rowEl,this).each(function(){a(f.checkEl,this).click(function(e){c(a(this).parents(f.rowEl))})}).click(function(e){var h=a(e.toElement?e.toElement:e.target),l=h.prop("tagName").toLowerCase();0<=a.inArray(l,["input","textarea","a","button","i"])&&"checkbox"!=h.attr("type")?e.stopPropagation():
c(this)});a(f.selectAllEl).click(function(){a(this).prop("checked")?a(f.rowEl,d).each(function(){var e=a(this);0<a(f.checkEl,this).prop("checked",!0).length&&e.addClass("checked")}):a(f.rowEl,d).each(function(){var e=a(this);0<a(f.checkEl,this).prop("checked",!1).length&&e.removeClass("checked")})});a(f.actionEl).click(function(){var e=a(this),h=e.attr("lang");h&&!confirm(h)||d.parents("form").attr("action",e.attr("href")).submit();return!1})}})($);
(function(a){a.tableDnD={currentTable:null,dragObject:null,mouseOffset:null,oldY:0,build:function(b){b=b||{};this.each(function(){this.tableDnDConfig={onDragStyle:b.onDragStyle,onDropStyle:b.onDropStyle,onDragClass:b.onDragClass?b.onDragClass:"tDnD_whileDrag",onDrop:b.onDrop,onDragStart:b.onDragStart,scrollAmount:b.scrollAmount?b.scrollAmount:5};a.tableDnD.makeDraggable(this);if(0==$("tfoot",this).length&&0<$("thead",this).length){var c=$("thead",this),d=$("th",c).length;c=$('<tfoot><tr><td style="padding:0;height:0;line-height:0;border:none" colspan="'+
d+'"></td></tr></tfoot>').insertAfter(c);d=$("tr:last",this);if("tfoot"!=d.parent().prop("tagName").toLowerCase()){d=$("td",d);var f=d.height();d.height(f-c.outerHeight())}}});a(document).bind("mousemove",a.tableDnD.mousemove).bind("mouseup",a.tableDnD.mouseup);return this},makeDraggable:function(b){for(var c=b.rows,d=b.tableDnDConfig,f=0;f<c.length;f++)$(c[f]).hasClass("nodrag")||a(c[f]).mousedown(function(e){if("TD"==e.target.tagName){a.tableDnD.dragObject=this;a.tableDnD.currentTable=b;a.tableDnD.mouseOffset=
a.tableDnD.getMouseOffset(this,e);if(d.onDragStart)d.onDragStart(b,this);return!1}}).css("cursor","move")},mouseCoords:function(b){return b.pageX||b.pageY?{x:b.pageX,y:b.pageY}:{x:b.clientX+document.body.scrollLeft-document.body.clientLeft,y:b.clientY+document.body.scrollTop-document.body.clientTop}},getMouseOffset:function(b,c){c=c||window.event;b=this.getPosition(b);c=this.mouseCoords(c);return{x:c.x-b.x,y:c.y-b.y}},getPosition:function(b){var c=0,d=0;0==b.offsetHeight&&(b=b.firstChild);for(;b.offsetParent;)c+=
b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;c+=b.offsetLeft;d+=b.offsetTop;return{x:c,y:d}},mousemove:function(b){if(null!=a.tableDnD.dragObject){var c=a(a.tableDnD.dragObject),d=a.tableDnD.currentTable.tableDnDConfig,f=a.tableDnD.mouseCoords(b);b=f.y-a.tableDnD.mouseOffset.y;var e=window.pageYOffset;document.all&&("undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?e=document.documentElement.scrollTop:"undefined"!=typeof document.body&&(e=document.body.scrollTop));f.y-e<d.scrollAmount?
window.scrollBy(0,-d.scrollAmount):(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight)-(f.y-e)<d.scrollAmount&&window.scrollBy(0,d.scrollAmount);b!=a.tableDnD.oldY&&(f=b>a.tableDnD.oldY,a.tableDnD.oldY=b,d.onDragClass?c.addClass(d.onDragClass):c.css(d.onDragStyle),(c=a.tableDnD.findDropTargetRow(c,b))&&(f&&a.tableDnD.dragObject!=c?a.tableDnD.dragObject.parentNode.insertBefore(a.tableDnD.dragObject,c.nextSibling):
f||a.tableDnD.dragObject==c||a.tableDnD.dragObject.parentNode.insertBefore(a.tableDnD.dragObject,c)));return!1}},findDropTargetRow:function(b,c){for(var d=a.tableDnD.currentTable.rows,f=0;f<d.length;f++){var e=d[f],h=this.getPosition(e).y,l=parseInt(e.offsetHeight)/2;0==e.offsetHeight&&(h=this.getPosition(e.firstChild).y,l=parseInt(e.firstChild.offsetHeight)/2);if(c>h-l&&c<h+l){if(e==b)break;c=a.tableDnD.currentTable.tableDnDConfig;if(c.onAllowDrop){if(!c.onAllowDrop(b,e))break}else if($(e).hasClass("nodrop"))break;
return e}}return null},mouseup:function(b){if(a.tableDnD.currentTable&&a.tableDnD.dragObject){b=a.tableDnD.dragObject;var c=a.tableDnD.currentTable.tableDnDConfig;c.onDragClass?a(b).removeClass(c.onDragClass):a(b).css(c.onDropStyle);a.tableDnD.dragObject=null;if(c.onDrop)c.onDrop(a.tableDnD.currentTable,b);a.tableDnD.currentTable=null}},serialize:function(){if(a.tableDnD.currentTable){for(var b="",c=a.tableDnD.currentTable.id,d=a.tableDnD.currentTable.rows,f=0;f<d.length;f++)0<b.length&&(b+="&"),
b+=c+"[]="+d[f].id;return b}return"Error: No Table id set, you need to set an id on your table and every row"}};a.fn.extend({tableDnD:a.tableDnD.build})})($);
(function(a){var b=function(){var h=document.createElement("input");h.setAttribute("onpaste","");return"function"===typeof h.onpaste?"paste":"input"}()+".mask",c=navigator.userAgent,d=/iphone/i.test(c),f=/android/i.test(c),e;a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"};a.fn.extend({caret:function(h,l){if(0!==this.length&&!this.is(":hidden")){if("number"==typeof h)return l="number"===typeof l?l:h,this.each(function(){this.setSelectionRange?this.setSelectionRange(h,
l):this.createTextRange&&(z=this.createTextRange(),z.collapse(!0),z.moveEnd("character",l),z.moveStart("character",h),z.select())});if(this[0].setSelectionRange)h=this[0].selectionStart,l=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var z=document.selection.createRange();h=0-z.duplicate().moveStart("character",-1E5);l=h+z.text.length}return{begin:h,end:l}}},unmask:function(){return this.trigger("unmask")},mask:function(h,l){var z;if(!h&&0<this.length){var C=a(this[0]);
return C.data(a.mask.dataName)()}l=a.extend({placeholder:a.mask.placeholder,completed:null},l);var t=a.mask.definitions;var y=[];var v=z=h.length;var F=null;a.each(h.split(""),function(A,E){"?"==E?(z--,v=A):t[E]?(y.push(new RegExp(t[E])),null===F&&(F=y.length-1)):y.push(null)});return this.trigger("unmask").each(function(){function A(p){for(;++p<z&&!y[p];);return p}function E(p,w){if(!(0>p)){var q=p;for(w=A(w);q<z;q++)if(y[q]){if(w<z&&y[q].test(D[w]))D[q]=D[w],D[w]=l.placeholder;else break;w=A(w)}n();
u.caret(Math.max(F,p))}}function m(p){var w=p.which;if(8===w||46===w||d&&127===w){var q=u.caret();var B=q.begin;q=q.end;if(0===q-B){if(46!==w)for(;0<=--B&&!y[B];);else B=q=A(B-1);q=46===w?A(q):q}r(B,q);E(B,q-1);p.preventDefault()}else 27==w&&(u.val(H),u.caret(0,x()),p.preventDefault())}function g(p){var w=p.which,q=u.caret();if(!(p.ctrlKey||p.altKey||p.metaKey||32>w)&&w){0!==q.end-q.begin&&(r(q.begin,q.end),E(q.begin,q.end-1));q=A(q.begin-1);if(q<z&&(w=String.fromCharCode(w),y[q].test(w))){var B;
var G=q;for(B=l.placeholder;G<z;G++)if(y[G]){var I=A(G);var J=D[G];D[G]=B;if(I<z&&y[I].test(J))B=J;else break}D[q]=w;n();q=A(q);f?setTimeout(a.proxy(a.fn.caret,u,q),0):u.caret(q);l.completed&&q>=z&&l.completed.call(u)}p.preventDefault()}}function r(p,w){for(;p<w&&p<z;p++)y[p]&&(D[p]=l.placeholder)}function n(){u.val(D.join(""))}function x(p){var w=u.val(),q=-1,B;for(pos=B=0;B<z;B++)if(y[B]){for(D[B]=l.placeholder;pos++<w.length;){var G=w.charAt(pos-1);if(y[B].test(G)){D[B]=G;q=B;break}}if(pos>w.length)break}else D[B]===
w.charAt(pos)&&B!==v&&(pos++,q=B);p?n():q+1<v?(u.val(""),r(0,z)):(n(),u.val(u.val().substring(0,q+1)));return v?B:F}var u=a(this),D=a.map(h.split(""),function(p,w){if("?"!=p)return t[p]?l.placeholder:p}),H=u.val();u.data(a.mask.dataName,function(){return a.map(D,function(p,w){return y[w]&&p!=l.placeholder?p:null}).join("")});u.attr("readonly")||u.one("unmask",function(){u.unbind(".mask").removeData(a.mask.dataName)}).bind("focus.mask",function(){clearTimeout(e);H=u.val();var p=x();e=setTimeout(function(){n();
p==h.length?u.caret(0,p):u.caret(p)},10)}).bind("blur.mask",function(){x();u.val()!=H&&u.change()}).bind("keydown.mask",m).bind("keypress.mask",g).bind(b,function(){setTimeout(function(){var p=x(!0);u.caret(p);l.completed&&p==u.val().length&&l.completed.call(u)},0)});x()})}})})(jQuery);
jQuery.fn.extend({getSelection:function(){var a=this.get(0);return a?("selectionStart"in a&&function(){var b=a.selectionEnd-a.selectionStart;return{start:a.selectionStart,end:a.selectionEnd,length:b,text:a.value.substr(a.selectionStart,b)}}||window.getSelection()&&function(){var b=window.getSelection().getRangeAt(0);return{start:b.startOffset,end:b.endOffset,length:b.endOffset-b.startOffset,text:b.toString()}}||document.selection&&function(){a.focus();var b=document.selection.createRange();if(null===
b)return{start:0,end:a.value.length,length:0};var c=a.createTextRange(),d=c.duplicate();c.moveToBookmark(b.getBookmark());d.setEndPoint("EndToStart",c);return{start:d.text.length,end:d.text.length+b.text.length,length:b.text.length,text:b.text}}||function(){return null})():null},setSelection:function(a,b){var c=this.get(0);c&&(c.setSelectionRange?(c.focus(),c.setSelectionRange(a,b)):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()))},
replaceSelection:function(a){var b=this.get(0);if(!b)return null;var c=a||"";return("selectionStart"in b&&function(){b.value=b.value.substr(0,b.selectionStart)+c+b.value.substr(b.selectionEnd,b.value.length);return this}||document.selection&&function(){b.focus();document.selection.createRange().text=c;return this}||function(){b.value+=c;return jQuery(b)})()}});
jQuery.cookie=function(a,b,c){if(1<arguments.length&&"[object Object]"!==String(b)){c=jQuery.extend({},c);if(null===b||void 0===b)c.expires=-1;if("number"===typeof c.expires){var d=c.expires,f=c.expires=new Date;f.setDate(f.getDate()+d)}b=String(b);return document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};f=c.raw?function(e){return e}:
decodeURIComponent;return(d=(new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)")).exec(document.cookie))?f(d[1]):null};
(function(a){function b(d){return"object"==typeof d?d:{top:d,left:d}}var c=a.scrollTo=function(d,f,e){a(window).scrollTo(d,f,e)};c.defaults={axis:"xy",duration:1.3<=parseFloat(a.fn.jquery)?0:1,limit:!0};c.window=function(d){return a(window)._scrollable()};a.fn._scrollable=function(){return this.map(function(){if(this.nodeName&&-1==a.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"]))return this;var d=(this.contentWindow||this).document||this.ownerDocument||this;return/webkit/i.test(navigator.userAgent)||
"BackCompat"==d.compatMode?d.body:d.documentElement})};a.fn.scrollTo=function(d,f,e){"object"==typeof f&&(e=f,f=0);"function"==typeof e&&(e={onAfter:e});"max"==d&&(d=9E9);e=a.extend({},c.defaults,e);f=f||e.duration;e.queue=e.queue&&1<e.axis.length;e.queue&&(f/=2);e.offset=b(e.offset);e.over=b(e.over);return this._scrollable().each(function(){function h(F){z.animate(t,f,e.easing,F&&function(){F.call(this,d,e)})}if(null!=d){var l=this,z=a(l),C=d,t={},y=z.is("html,body");switch(typeof C){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(C)){C=
b(C);break}C=a(C,this);if(!C.length)return;case "object":if(C.is||C.style)var v=(C=a(C)).offset()}a.each(e.axis.split(""),function(F,A){var E="x"==A?"Left":"Top",m=E.toLowerCase(),g="scroll"+E,r=l[g],n=c.max(l,A);v?(t[g]=v[m]+(y?0:r-z.offset()[m]),e.margin&&(t[g]-=parseInt(C.css("margin"+E))||0,t[g]-=parseInt(C.css("border"+E+"Width"))||0),t[g]+=e.offset[m]||0,e.over[m]&&(t[g]+=C["x"==A?"width":"height"]()*e.over[m])):(A=C[m],t[g]=A.slice&&"%"==A.slice(-1)?parseFloat(A)/100*n:A);e.limit&&/^\d+$/.test(t[g])&&
(t[g]=0>=t[g]?0:Math.min(t[g],n));!F&&e.queue&&(r!=t[g]&&h(e.onAfterFirst),delete t[g])});h(e.onAfter)}}).end()};c.max=function(d,f){var e="x"==f?"Width":"Height";f="scroll"+e;if(!a(d).is("html,body"))return d[f]-a(d)[e.toLowerCase()]();e="client"+e;var h=d.ownerDocument.documentElement;d=d.ownerDocument.body;return Math.max(h[f],d[f])-Math.min(h[e],d[e])}})(jQuery);jQuery.fn.css2=jQuery.fn.css;
jQuery.fn.css=function(){if(arguments.length)return jQuery.fn.css2.apply(this,arguments);for(var a="font-family font-size font-weight font-style color box-sizing text-transform text-decoration letter-spacing box-shadow line-height text-align vertical-align direction background-color background-image background-repeat background-position background-attachment opacity width height top right bottom left margin-top margin-right margin-bottom margin-left padding-top padding-right padding-bottom padding-left border-top-width border-right-width border-bottom-width border-left-width border-top-color border-right-color border-bottom-color border-left-color border-top-style border-right-style border-bottom-style border-left-style position display visibility z-index overflow-x overflow-y white-space clip float clear cursor list-style-image list-style-position list-style-type marker-offset word-wrap word-break word-spacing".split(" "),b=
a.length,c={},d=0;d<b;d++)c[a[d]]=jQuery.fn.css2.call(this,a[d]);return c};
